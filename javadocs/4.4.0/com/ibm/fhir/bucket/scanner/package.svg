<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="663px" preserveAspectRatio="none" style="width:1986px;height:663px;" version="1.1" viewBox="0 0 1986 663" width="1986px" zoomAndPan="magnify"><defs><filter height="300%" id="fbv3gzel90306" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--MD5=[b0d9575ab999429b72cc019b4a2a88d8]
cluster com.ibm.fhir.bucket.scanner--><polygon fill="#FFFFFF" filter="url(#fbv3gzel90306)" points="14,150,246,150,253,172.2969,1964,172.2969,1964,623,14,623,14,150" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="14" x2="253" y1="172.2969" y2="172.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="226" x="18" y="164.9951">com.ibm.fhir.bucket.scanner</text><!--MD5=[0d852700fdad35b7061d461d6907a324]
cluster java.io--><polygon fill="#FFFFFF" filter="url(#fbv3gzel90306)" points="92,16,148,16,155,38.2969,423,38.2969,423,125,92,125,92,16" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="92" x2="155" y1="38.2969" y2="38.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="50" x="96" y="30.9951">java.io</text><!--MD5=[dbdff8a2fae6c321988998aab8ea5b0a]
class com.ibm.fhir.bucket.scanner.Sha256InputStreamDecorator--><a href="Sha256InputStreamDecorator.html" target="_top" title="Sha256InputStreamDecorator.html" xlink:actuate="onRequest" xlink:href="Sha256InputStreamDecorator.html" xlink:show="new" xlink:title="Sha256InputStreamDecorator.html" xlink:type="simple"><rect fill="#FEFECE" filter="url(#fbv3gzel90306)" height="112.0234" id="com.ibm.fhir.bucket.scanner.Sha256InputStreamDecorator" style="stroke: #A80036; stroke-width: 1.5;" width="273" x="277.5" y="215.5"/><ellipse cx="316.35" cy="231.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M319.3188,237.1406 Q318.7406,237.4375 318.1,237.5781 Q317.4594,237.7344 316.7563,237.7344 Q314.2563,237.7344 312.9281,236.0938 Q311.6156,234.4375 311.6156,231.3125 Q311.6156,228.1875 312.9281,226.5313 Q314.2563,224.875 316.7563,224.875 Q317.4594,224.875 318.1,225.0313 Q318.7563,225.1875 319.3188,225.4844 L319.3188,228.2031 Q318.6938,227.625 318.1,227.3594 Q317.5063,227.0781 316.8813,227.0781 Q315.5375,227.0781 314.85,228.1563 Q314.1625,229.2188 314.1625,231.3125 Q314.1625,233.4063 314.85,234.4844 Q315.5375,235.5469 316.8813,235.5469 Q317.5063,235.5469 318.1,235.2813 Q318.6938,235 319.3188,234.4219 L319.3188,237.1406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="188" x="335.65" y="235.6543">Sha256InputStreamDecorator</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="278.5" x2="549.5" y1="247.5" y2="247.5"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="278.5" x2="549.5" y1="255.5" y2="255.5"/><ellipse cx="288.5" cy="266.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="247" x="297.5" y="269.7104">Sha256InputStreamDecorator(InputStream)</text><ellipse cx="288.5" cy="279.3047" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="140" x="297.5" y="282.5151">getBase64Hash(): String</text><ellipse cx="288.5" cy="292.1094" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="56" x="297.5" y="295.3198">read(): int</text><ellipse cx="288.5" cy="304.9141" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="132" x="297.5" y="308.1245">read(byte[], int, int): int</text><ellipse cx="288.5" cy="317.7188" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="69" x="297.5" y="320.9292">close(): void</text></a><!--MD5=[434e0b04adee20dec453537cb4a35e44]
class com.ibm.fhir.bucket.scanner.NoCloseInputStream--><a href="NoCloseInputStream.html" target="_top" title="NoCloseInputStream.html" xlink:actuate="onRequest" xlink:href="NoCloseInputStream.html" xlink:show="new" xlink:title="NoCloseInputStream.html" xlink:type="simple"><rect fill="#FEFECE" filter="url(#fbv3gzel90306)" height="73.6094" id="com.ibm.fhir.bucket.scanner.NoCloseInputStream" style="stroke: #A80036; stroke-width: 1.5;" width="221" x="21.5" y="234.5"/><ellipse cx="63.95" cy="250.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M66.9188,256.1406 Q66.3406,256.4375 65.7,256.5781 Q65.0594,256.7344 64.3563,256.7344 Q61.8563,256.7344 60.5281,255.0938 Q59.2156,253.4375 59.2156,250.3125 Q59.2156,247.1875 60.5281,245.5313 Q61.8563,243.875 64.3563,243.875 Q65.0594,243.875 65.7,244.0313 Q66.3563,244.1875 66.9188,244.4844 L66.9188,247.2031 Q66.2938,246.625 65.7,246.3594 Q65.1063,246.0781 64.4813,246.0781 Q63.1375,246.0781 62.45,247.1563 Q61.7625,248.2188 61.7625,250.3125 Q61.7625,252.4063 62.45,253.4844 Q63.1375,254.5469 64.4813,254.5469 Q65.1063,254.5469 65.7,254.2813 Q66.2938,254 66.9188,253.4219 L66.9188,256.1406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="128" x="84.05" y="254.6543">NoCloseInputStream</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="22.5" x2="241.5" y1="266.5" y2="266.5"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="22.5" x2="241.5" y1="274.5" y2="274.5"/><ellipse cx="32.5" cy="285.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="195" x="41.5" y="288.7104">NoCloseInputStream(InputStream)</text><ellipse cx="32.5" cy="298.3047" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="69" x="41.5" y="301.5151">close(): void</text></a><!--MD5=[5da28120c68ca992e1f1d65bc7d035a4]
class com.ibm.fhir.bucket.scanner.LoaderQueue--><a href="LoaderQueue.html" target="_top" title="LoaderQueue.html" xlink:actuate="onRequest" xlink:href="LoaderQueue.html" xlink:show="new" xlink:title="LoaderQueue.html" xlink:type="simple"><rect fill="#FEFECE" filter="url(#fbv3gzel90306)" height="60.8047" id="com.ibm.fhir.bucket.scanner.LoaderQueue" style="stroke: #A80036; stroke-width: 1.5;" width="216" x="586" y="241"/><ellipse cx="647.75" cy="257" fill="#B4A7E5" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M643.6719,252.7656 L643.6719,250.6094 L651.0625,250.6094 L651.0625,252.7656 L648.5938,252.7656 L648.5938,260.8438 L651.0625,260.8438 L651.0625,263 L643.6719,263 L643.6719,260.8438 L646.1406,260.8438 L646.1406,252.7656 L643.6719,252.7656 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="84" x="668.25" y="261.1543">LoaderQueue</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="587" x2="801" y1="273" y2="273"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="587" x2="801" y1="281" y2="281"/><ellipse cx="597" cy="292" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="190" x="606" y="295.2104">processEntry(String, String): void</text></a><!--MD5=[0e3cd8e43eee1ca12f784a2afaf30c31]
class com.ibm.fhir.bucket.scanner.DataAccess--><a href="DataAccess.html" target="_top" title="DataAccess.html" xlink:actuate="onRequest" xlink:href="DataAccess.html" xlink:show="new" xlink:title="DataAccess.html" xlink:type="simple"><rect fill="#FEFECE" filter="url(#fbv3gzel90306)" height="188.8516" id="com.ibm.fhir.bucket.scanner.DataAccess" style="stroke: #A80036; stroke-width: 1.5;" width="368" x="837" y="177"/><ellipse cx="979.75" cy="193" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M982.7188,198.6406 Q982.1406,198.9375 981.5,199.0781 Q980.8594,199.2344 980.1563,199.2344 Q977.6563,199.2344 976.3281,197.5938 Q975.0156,195.9375 975.0156,192.8125 Q975.0156,189.6875 976.3281,188.0313 Q977.6563,186.375 980.1563,186.375 Q980.8594,186.375 981.5,186.5313 Q982.1563,186.6875 982.7188,186.9844 L982.7188,189.7031 Q982.0938,189.125 981.5,188.8594 Q980.9063,188.5781 980.2813,188.5781 Q978.9375,188.5781 978.25,189.6563 Q977.5625,190.7188 977.5625,192.8125 Q977.5625,194.9063 978.25,195.9844 Q978.9375,197.0469 980.2813,197.0469 Q980.9063,197.0469 981.5,196.7813 Q982.0938,196.5 982.7188,195.9219 L982.7188,198.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="74" x="1000.25" y="197.1543">DataAccess</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="838" x2="1204" y1="209" y2="209"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="838" x2="1204" y1="217" y2="217"/><ellipse cx="848" cy="228" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="342" x="857" y="231.2104">DataAccess(IDatabaseAdapter, ITransactionProvider, String)</text><ellipse cx="848" cy="240.8047" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="56" x="857" y="244.0151">init(): void</text><ellipse cx="848" cy="253.6094" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="194" x="857" y="256.8198">registerBucketItem(CosItem): void</text><ellipse cx="848" cy="266.4141" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="337" x="857" y="269.6245">allocateJobs(List&lt;BucketLoaderJob&gt;, FileType, int, int): void</text><ellipse cx="848" cy="279.2188" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="303" x="857" y="282.4292">recordLogicalId(String, String, long, int, Integer): void</text><ellipse cx="848" cy="292.0234" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="94" x="857" y="295.2339">heartbeat(): void</text><ellipse cx="848" cy="304.8281" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="208" x="857" y="308.0386">markJobDone(BucketLoaderJob): void</text><ellipse cx="848" cy="317.6328" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="340" x="857" y="320.8433">recordLogicalIds(long, int, List&lt;ResourceIdValue&gt;, int): void</text><ellipse cx="848" cy="330.4375" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="325" x="857" y="333.6479">recordErrors(long, int, List&lt;ResourceBundleError&gt;): void</text><ellipse cx="848" cy="343.2422" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="272" x="857" y="346.4526">getLastProcessedLineNumber(long, int): Integer</text><ellipse cx="848" cy="356.0469" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="330" x="857" y="359.2573">getResourceRefsForLine(long, int, int): List&lt;ResourceRef&gt;</text></a><!--MD5=[2f2d3ee6dd4278a22c433ffa5b3f9e3c]
class com.ibm.fhir.bucket.scanner.CosReader--><a href="CosReader.html" target="_top" title="CosReader.html" xlink:actuate="onRequest" xlink:href="CosReader.html" xlink:show="new" xlink:title="CosReader.html" xlink:type="simple"><rect fill="#FEFECE" filter="url(#fbv3gzel90306)" height="176.0469" id="com.ibm.fhir.bucket.scanner.CosReader" style="stroke: #A80036; stroke-width: 1.5;" width="716" x="1240" y="183.5"/><ellipse cx="1559.75" cy="199.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1562.7188,205.1406 Q1562.1406,205.4375 1561.5,205.5781 Q1560.8594,205.7344 1560.1563,205.7344 Q1557.6563,205.7344 1556.3281,204.0938 Q1555.0156,202.4375 1555.0156,199.3125 Q1555.0156,196.1875 1556.3281,194.5313 Q1557.6563,192.875 1560.1563,192.875 Q1560.8594,192.875 1561.5,193.0313 Q1562.1563,193.1875 1562.7188,193.4844 L1562.7188,196.2031 Q1562.0938,195.625 1561.5,195.3594 Q1560.9063,195.0781 1560.2813,195.0781 Q1558.9375,195.0781 1558.25,196.1563 Q1557.5625,197.2188 1557.5625,199.3125 Q1557.5625,201.4063 1558.25,202.4844 Q1558.9375,203.5469 1560.2813,203.5469 Q1560.9063,203.5469 1561.5,203.2813 Q1562.0938,203 1562.7188,202.4219 L1562.7188,205.1406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="68" x="1580.25" y="203.6543">CosReader</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1241" x2="1955" y1="215.5" y2="215.5"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="1241" x2="1955" y1="223.5" y2="223.5"/><ellipse cx="1251" cy="234.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="690" x="1260" y="237.7104">CosReader(ExecutorService, FileType, CosClient, Consumer&lt;ResourceEntry&gt;, int, DataAccess, boolean, int, boolean, int)</text><ellipse cx="1251" cy="247.3047" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="99" x="1260" y="250.5151">signalStop(): void</text><ellipse cx="1251" cy="260.1094" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="106" x="1260" y="263.3198">waitForStop(): void</text><ellipse cx="1251" cy="272.9141" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="56" x="1260" y="276.1245">init(): void</text><ellipse cx="1251" cy="285.7188" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="148" x="1260" y="288.9292">mainAllocationLoop(): void</text><polygon fill="#FFFF44" points="1251,293.5234,1255,297.5234,1251,301.5234,1247,297.5234" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="120" x="1260" y="301.7339">safeSleep(long): void</text><polygon fill="#FFFF44" points="1251,306.3281,1255,310.3281,1251,314.3281,1247,310.3281" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="208" x="1260" y="314.5386">markJobDone(BucketLoaderJob): void</text><ellipse cx="1251" cy="324.1328" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="320" x="1260" y="327.3433">processNDJSON(BucketLoaderJob, BufferedReader): void</text><polygon fill="#FFFF44" points="1251,331.9375,1255,335.9375,1251,339.9375,1247,335.9375" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="326" x="1260" y="340.1479">process(BucketLoaderJob, Resource, int, String): boolean</text><ellipse cx="1251" cy="349.7422" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="210" x="1260" y="352.9526">validateInput(Resource): List&lt;Issue&gt;</text></a><!--MD5=[bb92dc037dab9e7188241d686cc36a7e]
class com.ibm.fhir.bucket.scanner.ResourceHandler--><a href="ResourceHandler.html" target="_top" title="ResourceHandler.html" xlink:actuate="onRequest" xlink:href="ResourceHandler.html" xlink:show="new" xlink:title="ResourceHandler.html" xlink:type="simple"><rect fill="#FEFECE" filter="url(#fbv3gzel90306)" height="137.6328" id="com.ibm.fhir.bucket.scanner.ResourceHandler" style="stroke: #A80036; stroke-width: 1.5;" width="384" x="502" y="451.5"/><ellipse cx="635.75" cy="467.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M638.7188,473.1406 Q638.1406,473.4375 637.5,473.5781 Q636.8594,473.7344 636.1563,473.7344 Q633.6563,473.7344 632.3281,472.0938 Q631.0156,470.4375 631.0156,467.3125 Q631.0156,464.1875 632.3281,462.5313 Q633.6563,460.875 636.1563,460.875 Q636.8594,460.875 637.5,461.0313 Q638.1563,461.1875 638.7188,461.4844 L638.7188,464.2031 Q638.0938,463.625 637.5,463.3594 Q636.9063,463.0781 636.2813,463.0781 Q634.9375,463.0781 634.25,464.1563 Q633.5625,465.2188 633.5625,467.3125 Q633.5625,469.4063 634.25,470.4844 Q634.9375,471.5469 636.2813,471.5469 Q636.9063,471.5469 637.5,471.2813 Q638.0938,471 638.7188,470.4219 L638.7188,473.1406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="108" x="656.25" y="471.6543">ResourceHandler</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="503" x2="885" y1="483.5" y2="483.5"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="503" x2="885" y1="491.5" y2="491.5"/><ellipse cx="513" cy="502.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="353" x="522" y="505.7104">ResourceHandler(ExecutorService, int, FhirClient, DataAccess)</text><ellipse cx="513" cy="515.3047" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="99" x="522" y="518.5151">signalStop(): void</text><ellipse cx="513" cy="528.1094" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="106" x="522" y="531.3198">waitForStop(): void</text><ellipse cx="513" cy="540.9141" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="189" x="522" y="544.1245">process(ResourceEntry): boolean</text><ellipse cx="513" cy="553.7188" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="186" x="522" y="556.9292">processThr(ResourceEntry): void</text><polygon fill="#FFFF44" points="513,561.5234,517,565.5234,513,569.5234,509,565.5234" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="358" x="522" y="569.7339">processBadRequest(ResourceEntry, FhirServerResponse): void</text><ellipse cx="513" cy="579.3281" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="56" x="522" y="582.5386">init(): void</text></a><!--MD5=[117b4744d87af26d6202ac4a9292f012]
class com.ibm.fhir.bucket.scanner.CosScanner--><a href="CosScanner.html" target="_top" title="CosScanner.html" xlink:actuate="onRequest" xlink:href="CosScanner.html" xlink:show="new" xlink:title="CosScanner.html" xlink:type="simple"><rect fill="#FEFECE" filter="url(#fbv3gzel90306)" height="188.8516" id="com.ibm.fhir.bucket.scanner.CosScanner" style="stroke: #A80036; stroke-width: 1.5;" width="501" x="921.5" y="426"/><ellipse cx="1130.25" cy="442" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1133.2188,447.6406 Q1132.6406,447.9375 1132,448.0781 Q1131.3594,448.2344 1130.6563,448.2344 Q1128.1563,448.2344 1126.8281,446.5938 Q1125.5156,444.9375 1125.5156,441.8125 Q1125.5156,438.6875 1126.8281,437.0313 Q1128.1563,435.375 1130.6563,435.375 Q1131.3594,435.375 1132,435.5313 Q1132.6563,435.6875 1133.2188,435.9844 L1133.2188,438.7031 Q1132.5938,438.125 1132,437.8594 Q1131.4063,437.5781 1130.7813,437.5781 Q1129.4375,437.5781 1128.75,438.6563 Q1128.0625,439.7188 1128.0625,441.8125 Q1128.0625,443.9063 1128.75,444.9844 Q1129.4375,446.0469 1130.7813,446.0469 Q1131.4063,446.0469 1132,445.7813 Q1132.5938,445.5 1133.2188,444.9219 L1133.2188,447.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="75" x="1150.75" y="446.1543">CosScanner</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="922.5" x2="1421.5" y1="458" y2="458"/><ellipse cx="932.5" cy="469" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="178" x="941.5" y="472.2104">HEARTBEAT_INTERVAL_MS: long</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="922.5" x2="1421.5" y1="478.8047" y2="478.8047"/><ellipse cx="932.5" cy="489.8047" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="475" x="941.5" y="493.0151">CosScanner(CosClient, Collection&lt;String&gt;, DataAccess, Set&lt;FileType&gt;, String, int)</text><ellipse cx="932.5" cy="502.6094" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="56" x="941.5" y="505.8198">init(): void</text><ellipse cx="932.5" cy="515.4141" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="99" x="941.5" y="518.6245">signalStop(): void</text><ellipse cx="932.5" cy="528.2188" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="106" x="941.5" y="531.4292">waitForStop(): void</text><ellipse cx="932.5" cy="541.0234" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="94" x="941.5" y="544.2339">mainLoop(): void</text><polygon fill="#FFFF44" points="932.5,548.8281,936.5,552.8281,932.5,556.8281,928.5,552.8281" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="120" x="941.5" y="557.0386">safeSleep(long): void</text><polygon fill="#FFFF44" points="932.5,561.6328,936.5,565.6328,932.5,569.6328,928.5,565.6328" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="66" x="941.5" y="569.8433">scan(): void</text><polygon fill="#FFFF44" points="932.5,574.4375,936.5,578.4375,932.5,582.4375,928.5,578.4375" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="145" x="941.5" y="582.6479">fileTyper(String): FileType</text><polygon fill="#FFFF44" points="932.5,587.2422,936.5,591.2422,932.5,595.2422,928.5,591.2422" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="124" x="941.5" y="595.4526">handle(CosItem): void</text><polygon fill="#FFFF44" points="932.5,600.0469,936.5,604.0469,932.5,608.0469,928.5,604.0469" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="94" x="941.5" y="608.2573">heartbeat(): void</text></a><!--MD5=[fa9a3b769145f837d7bc2faadf88dde7]
class java.io.InputStream--><a href="https://docs.oracle.com/javase/8/docs/api/java/io/InputStream.html?is-external=true" target="_top" title="https://docs.oracle.com/javase/8/docs/api/java/io/InputStream.html?is-external=true" xlink:actuate="onRequest" xlink:href="https://docs.oracle.com/javase/8/docs/api/java/io/InputStream.html?is-external=true" xlink:show="new" xlink:title="https://docs.oracle.com/javase/8/docs/api/java/io/InputStream.html?is-external=true" xlink:type="simple"><rect fill="#FEFECE" filter="url(#fbv3gzel90306)" height="60.8047" id="java.io.InputStream" style="stroke: #A80036; stroke-width: 1.5;" width="109" x="305.5" y="49.5"/><ellipse cx="320.5" cy="65.5" fill="#A9DCDF" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M320.6094,60.8438 L319.4531,65.9219 L321.7813,65.9219 L320.6094,60.8438 Z M319.125,58.6094 L322.1094,58.6094 L325.4688,71 L323.0156,71 L322.25,67.9375 L318.9688,67.9375 L318.2188,71 L315.7813,71 L319.125,58.6094 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="77" x="334.5" y="69.6543">InputStream</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="306.5" x2="413.5" y1="81.5" y2="81.5"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="306.5" x2="413.5" y1="89.5" y2="89.5"/><ellipse cx="316.5" cy="100.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="56" x="325.5" y="103.7104">read(): int</text></a><!--MD5=[7bc894eae69de9994c6e46ebc6cb7767]
class java.io.PushbackInputStream--><a href="https://docs.oracle.com/javase/8/docs/api/java/io/PushbackInputStream.html?is-external=true" target="_top" title="https://docs.oracle.com/javase/8/docs/api/java/io/PushbackInputStream.html?is-external=true" xlink:actuate="onRequest" xlink:href="https://docs.oracle.com/javase/8/docs/api/java/io/PushbackInputStream.html?is-external=true" xlink:show="new" xlink:title="https://docs.oracle.com/javase/8/docs/api/java/io/PushbackInputStream.html?is-external=true" xlink:type="simple"><rect fill="#FEFECE" filter="url(#fbv3gzel90306)" height="73.6094" id="java.io.PushbackInputStream" style="stroke: #A80036; stroke-width: 1.5;" width="170" x="100" y="43"/><ellipse cx="115" cy="59" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M117.9688,64.6406 Q117.3906,64.9375 116.75,65.0781 Q116.1094,65.2344 115.4063,65.2344 Q112.9063,65.2344 111.5781,63.5938 Q110.2656,61.9375 110.2656,58.8125 Q110.2656,55.6875 111.5781,54.0313 Q112.9063,52.375 115.4063,52.375 Q116.1094,52.375 116.75,52.5313 Q117.4063,52.6875 117.9688,52.9844 L117.9688,55.7031 Q117.3438,55.125 116.75,54.8594 Q116.1563,54.5781 115.5313,54.5781 Q114.1875,54.5781 113.5,55.6563 Q112.8125,56.7188 112.8125,58.8125 Q112.8125,60.9063 113.5,61.9844 Q114.1875,63.0469 115.5313,63.0469 Q116.1563,63.0469 116.75,62.7813 Q117.3438,62.5 117.9688,61.9219 L117.9688,64.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="138" x="129" y="63.1543">PushbackInputStream</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="101" x2="269" y1="75" y2="75"/><polygon fill="none" points="111,81,115,85,111,89,107,85" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="58" x="120" y="89.2104">buf: byte[]</text><polygon fill="none" points="111,93.8047,115,97.8047,111,101.8047,107,97.8047" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="43" x="120" y="102.0151">pos: int</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="101" x2="269" y1="108.6094" y2="108.6094"/></a><!--MD5=[869ba41b732a6c73c189fc634a550b36]
reverse link java.io.InputStream to com.ibm.fhir.bucket.scanner.Sha256InputStreamDecorator--><path d="M374.1685,130.2457 C381.5346,156.368 390.5609,188.3781 398.1574,215.3175 " fill="none" id="java.io.InputStream&lt;-com.ibm.fhir.bucket.scanner.Sha256InputStreamDecorator" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="367.3668,131.917,368.676,110.7678,380.8414,128.1173,367.3668,131.917" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[99ab7726ceb1317eb372bc9558f40dad]
reverse link java.io.PushbackInputStream to com.ibm.fhir.bucket.scanner.NoCloseInputStream--><path d="M169.2521,136.9005 C160.5449,168.3614 149.9727,206.5609 142.3187,234.2165 " fill="none" id="java.io.PushbackInputStream&lt;-com.ibm.fhir.bucket.scanner.NoCloseInputStream" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="162.5741,134.786,174.6552,117.3777,176.0669,138.5203,162.5741,134.786" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[a96f440b4d66d729671969e863a3e6ff]
link com.ibm.fhir.bucket.scanner.LoaderQueue to com.ibm.fhir.bucket.scanner.DataAccess--><!--MD5=[e581d388a8e8ee3cb7e515c625de995a]
link com.ibm.fhir.bucket.scanner.DataAccess to com.ibm.fhir.bucket.scanner.CosReader--><!--MD5=[35497b7245a8c320f80f882a19199347]
link com.ibm.fhir.bucket.scanner.LoaderQueue to com.ibm.fhir.bucket.scanner.ResourceHandler--><!--MD5=[9f08a380fbdfe3cca4970d93001a8320]
link com.ibm.fhir.bucket.scanner.ResourceHandler to com.ibm.fhir.bucket.scanner.CosScanner--><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="186" x="902" y="650.2822">UMLDoclet 2.0.7, PlantUML 1.2019.12</text><!--MD5=[d20469bf7d385d75743e2c3010c7fb6e]
@startuml
    namespace com.ibm.fhir.bucket.scanner {

        class Sha256InputStreamDecorator [[Sha256InputStreamDecorator.html]] {
            +Sha256InputStreamDecorator(InputStream)
            +getBase64Hash(): String
            +read(): int
            +read(byte[], int, int): int
            +close(): void
        }

        class NoCloseInputStream [[NoCloseInputStream.html]] {
            +NoCloseInputStream(InputStream)
            +close(): void
        }

        interface LoaderQueue [[LoaderQueue.html]] {
            {abstract} +processEntry(String, String): void
        }

        class DataAccess [[DataAccess.html]] {
            +DataAccess(IDatabaseAdapter, ITransactionProvider, String)
            +init(): void
            +registerBucketItem(CosItem): void
            +allocateJobs(List<BucketLoaderJob>, FileType, int, int): void
            +recordLogicalId(String, String, long, int, Integer): void
            +heartbeat(): void
            +markJobDone(BucketLoaderJob): void
            +recordLogicalIds(long, int, List<ResourceIdValue>, int): void
            +recordErrors(long, int, List<ResourceBundleError>): void
            +getLastProcessedLineNumber(long, int): Integer
            +getResourceRefsForLine(long, int, int): List<ResourceRef>
        }

        class CosReader [[CosReader.html]] {
            +CosReader(ExecutorService, FileType, CosClient, Consumer<ResourceEntry>, int, DataAccess, boolean, int, boolean, int)
            +signalStop(): void
            +waitForStop(): void
            +init(): void
            +mainAllocationLoop(): void
            #safeSleep(long): void
            #markJobDone(BucketLoaderJob): void
            +processNDJSON(BucketLoaderJob, BufferedReader): void
            #process(BucketLoaderJob, Resource, int, String): boolean
            +validateInput(Resource): List<Issue>
        }

        class ResourceHandler [[ResourceHandler.html]] {
            +ResourceHandler(ExecutorService, int, FhirClient, DataAccess)
            +signalStop(): void
            +waitForStop(): void
            +process(ResourceEntry): boolean
            +processThr(ResourceEntry): void
            #processBadRequest(ResourceEntry, FhirServerResponse): void
            +init(): void
        }

        class CosScanner [[CosScanner.html]] {
            {static} +HEARTBEAT_INTERVAL_MS: long
            +CosScanner(CosClient, Collection<String>, DataAccess, Set<FileType>, String, int)
            +init(): void
            +signalStop(): void
            +waitForStop(): void
            +mainLoop(): void
            #safeSleep(long): void
            #scan(): void
            {static} #fileTyper(String): FileType
            #handle(CosItem): void
            #heartbeat(): void
        }

        java.io.InputStream <|- - Sha256InputStreamDecorator
        java.io.PushbackInputStream <|- - NoCloseInputStream
    }

    namespace java.io {
        abstract class InputStream [[https://docs.oracle.com/javase/8/docs/api/java/io/InputStream.html?is-external=true]] {
            {abstract} +read(): int
        }
        class PushbackInputStream [[https://docs.oracle.com/javase/8/docs/api/java/io/PushbackInputStream.html?is-external=true]] {
            #buf: byte[]
            #pos: int
        }
    }

    center footer UMLDoclet 2.0.7, PlantUML 1.2019.12
@enduml

PlantUML version 1.2019.12(Sun Nov 03 10:24:54 UTC 2019)
(APACHE source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.8+10
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>