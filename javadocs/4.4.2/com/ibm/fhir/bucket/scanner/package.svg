<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="663px" preserveAspectRatio="none" style="width:1655px;height:663px;" version="1.1" viewBox="0 0 1655 663" width="1655px" zoomAndPan="magnify"><defs><filter height="300%" id="f16j4sa1a5as3o" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--MD5=[b0d9575ab999429b72cc019b4a2a88d8]
cluster com.ibm.fhir.bucket.scanner--><polygon fill="#FFFFFF" filter="url(#f16j4sa1a5as3o)" points="14,150,246,150,253,172.2969,1633,172.2969,1633,623,14,623,14,150" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="14" x2="253" y1="172.2969" y2="172.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="226" x="18" y="164.9951">com.ibm.fhir.bucket.scanner</text><!--MD5=[0d852700fdad35b7061d461d6907a324]
cluster java.io--><polygon fill="#FFFFFF" filter="url(#f16j4sa1a5as3o)" points="149,16,205,16,212,38.2969,480,38.2969,480,125,149,125,149,16" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="149" x2="212" y1="38.2969" y2="38.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="50" x="153" y="30.9951">java.io</text><!--MD5=[0e3cd8e43eee1ca12f784a2afaf30c31]
class com.ibm.fhir.bucket.scanner.DataAccess--><a href="DataAccess.html" target="_top" title="DataAccess.html" xlink:actuate="onRequest" xlink:href="DataAccess.html" xlink:show="new" xlink:title="DataAccess.html" xlink:type="simple"><rect fill="#FEFECE" filter="url(#f16j4sa1a5as3o)" height="188.8516" id="com.ibm.fhir.bucket.scanner.DataAccess" style="stroke: #A80036; stroke-width: 1.5;" width="368" x="587" y="177"/><ellipse cx="729.75" cy="193" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M732.7188,198.6406 Q732.1406,198.9375 731.5,199.0781 Q730.8594,199.2344 730.1563,199.2344 Q727.6563,199.2344 726.3281,197.5938 Q725.0156,195.9375 725.0156,192.8125 Q725.0156,189.6875 726.3281,188.0313 Q727.6563,186.375 730.1563,186.375 Q730.8594,186.375 731.5,186.5313 Q732.1563,186.6875 732.7188,186.9844 L732.7188,189.7031 Q732.0938,189.125 731.5,188.8594 Q730.9063,188.5781 730.2813,188.5781 Q728.9375,188.5781 728.25,189.6563 Q727.5625,190.7188 727.5625,192.8125 Q727.5625,194.9063 728.25,195.9844 Q728.9375,197.0469 730.2813,197.0469 Q730.9063,197.0469 731.5,196.7813 Q732.0938,196.5 732.7188,195.9219 L732.7188,198.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="74" x="750.25" y="197.1543">DataAccess</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="588" x2="954" y1="209" y2="209"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="588" x2="954" y1="217" y2="217"/><ellipse cx="598" cy="228" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="342" x="607" y="231.2104">DataAccess(IDatabaseAdapter, ITransactionProvider, String)</text><ellipse cx="598" cy="240.8047" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="56" x="607" y="244.0151">init(): void</text><ellipse cx="598" cy="253.6094" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="194" x="607" y="256.8198">registerBucketItem(CosItem): void</text><ellipse cx="598" cy="266.4141" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="337" x="607" y="269.6245">allocateJobs(List&lt;BucketLoaderJob&gt;, FileType, int, int): void</text><ellipse cx="598" cy="279.2188" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="303" x="607" y="282.4292">recordLogicalId(String, String, long, int, Integer): void</text><ellipse cx="598" cy="292.0234" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="94" x="607" y="295.2339">heartbeat(): void</text><ellipse cx="598" cy="304.8281" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="208" x="607" y="308.0386">markJobDone(BucketLoaderJob): void</text><ellipse cx="598" cy="317.6328" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="340" x="607" y="320.8433">recordLogicalIds(long, int, List&lt;ResourceIdValue&gt;, int): void</text><ellipse cx="598" cy="330.4375" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="325" x="607" y="333.6479">recordErrors(long, int, List&lt;ResourceBundleError&gt;): void</text><ellipse cx="598" cy="343.2422" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="272" x="607" y="346.4526">getLastProcessedLineNumber(long, int): Integer</text><ellipse cx="598" cy="356.0469" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="330" x="607" y="359.2573">getResourceRefsForLine(long, int, int): List&lt;ResourceRef&gt;</text></a><!--MD5=[5da28120c68ca992e1f1d65bc7d035a4]
class com.ibm.fhir.bucket.scanner.LoaderQueue--><a href="LoaderQueue.html" target="_top" title="LoaderQueue.html" xlink:actuate="onRequest" xlink:href="LoaderQueue.html" xlink:show="new" xlink:title="LoaderQueue.html" xlink:type="simple"><rect fill="#FEFECE" filter="url(#f16j4sa1a5as3o)" height="60.8047" id="com.ibm.fhir.bucket.scanner.LoaderQueue" style="stroke: #A80036; stroke-width: 1.5;" width="216" x="990" y="241"/><ellipse cx="1051.75" cy="257" fill="#B4A7E5" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1047.6719,252.7656 L1047.6719,250.6094 L1055.0625,250.6094 L1055.0625,252.7656 L1052.5938,252.7656 L1052.5938,260.8438 L1055.0625,260.8438 L1055.0625,263 L1047.6719,263 L1047.6719,260.8438 L1050.1406,260.8438 L1050.1406,252.7656 L1047.6719,252.7656 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="84" x="1072.25" y="261.1543">LoaderQueue</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="991" x2="1205" y1="273" y2="273"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="991" x2="1205" y1="281" y2="281"/><ellipse cx="1001" cy="292" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="190" x="1010" y="295.2104">processEntry(String, String): void</text></a><!--MD5=[bb92dc037dab9e7188241d686cc36a7e]
class com.ibm.fhir.bucket.scanner.ResourceHandler--><a href="ResourceHandler.html" target="_top" title="ResourceHandler.html" xlink:actuate="onRequest" xlink:href="ResourceHandler.html" xlink:show="new" xlink:title="ResourceHandler.html" xlink:type="simple"><rect fill="#FEFECE" filter="url(#f16j4sa1a5as3o)" height="137.6328" id="com.ibm.fhir.bucket.scanner.ResourceHandler" style="stroke: #A80036; stroke-width: 1.5;" width="384" x="1241" y="202.5"/><ellipse cx="1374.75" cy="218.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1377.7188,224.1406 Q1377.1406,224.4375 1376.5,224.5781 Q1375.8594,224.7344 1375.1563,224.7344 Q1372.6563,224.7344 1371.3281,223.0938 Q1370.0156,221.4375 1370.0156,218.3125 Q1370.0156,215.1875 1371.3281,213.5313 Q1372.6563,211.875 1375.1563,211.875 Q1375.8594,211.875 1376.5,212.0313 Q1377.1563,212.1875 1377.7188,212.4844 L1377.7188,215.2031 Q1377.0938,214.625 1376.5,214.3594 Q1375.9063,214.0781 1375.2813,214.0781 Q1373.9375,214.0781 1373.25,215.1563 Q1372.5625,216.2188 1372.5625,218.3125 Q1372.5625,220.4063 1373.25,221.4844 Q1373.9375,222.5469 1375.2813,222.5469 Q1375.9063,222.5469 1376.5,222.2813 Q1377.0938,222 1377.7188,221.4219 L1377.7188,224.1406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="108" x="1395.25" y="222.6543">ResourceHandler</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1242" x2="1624" y1="234.5" y2="234.5"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="1242" x2="1624" y1="242.5" y2="242.5"/><ellipse cx="1252" cy="253.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="353" x="1261" y="256.7104">ResourceHandler(ExecutorService, int, FhirClient, DataAccess)</text><ellipse cx="1252" cy="266.3047" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="99" x="1261" y="269.5151">signalStop(): void</text><ellipse cx="1252" cy="279.1094" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="106" x="1261" y="282.3198">waitForStop(): void</text><ellipse cx="1252" cy="291.9141" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="189" x="1261" y="295.1245">process(ResourceEntry): boolean</text><ellipse cx="1252" cy="304.7188" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="186" x="1261" y="307.9292">processThr(ResourceEntry): void</text><polygon fill="#FFFF44" points="1252,312.5234,1256,316.5234,1252,320.5234,1248,316.5234" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="358" x="1261" y="320.7339">processBadRequest(ResourceEntry, FhirServerResponse): void</text><ellipse cx="1252" cy="330.3281" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="56" x="1261" y="333.5386">init(): void</text></a><!--MD5=[117b4744d87af26d6202ac4a9292f012]
class com.ibm.fhir.bucket.scanner.CosScanner--><a href="CosScanner.html" target="_top" title="CosScanner.html" xlink:actuate="onRequest" xlink:href="CosScanner.html" xlink:show="new" xlink:title="CosScanner.html" xlink:type="simple"><rect fill="#FEFECE" filter="url(#f16j4sa1a5as3o)" height="188.8516" id="com.ibm.fhir.bucket.scanner.CosScanner" style="stroke: #A80036; stroke-width: 1.5;" width="501" x="372.5" y="426"/><ellipse cx="581.25" cy="442" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M584.2188,447.6406 Q583.6406,447.9375 583,448.0781 Q582.3594,448.2344 581.6563,448.2344 Q579.1563,448.2344 577.8281,446.5938 Q576.5156,444.9375 576.5156,441.8125 Q576.5156,438.6875 577.8281,437.0313 Q579.1563,435.375 581.6563,435.375 Q582.3594,435.375 583,435.5313 Q583.6563,435.6875 584.2188,435.9844 L584.2188,438.7031 Q583.5938,438.125 583,437.8594 Q582.4063,437.5781 581.7813,437.5781 Q580.4375,437.5781 579.75,438.6563 Q579.0625,439.7188 579.0625,441.8125 Q579.0625,443.9063 579.75,444.9844 Q580.4375,446.0469 581.7813,446.0469 Q582.4063,446.0469 583,445.7813 Q583.5938,445.5 584.2188,444.9219 L584.2188,447.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="75" x="601.75" y="446.1543">CosScanner</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="373.5" x2="872.5" y1="458" y2="458"/><ellipse cx="383.5" cy="469" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="178" x="392.5" y="472.2104">HEARTBEAT_INTERVAL_MS: long</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="373.5" x2="872.5" y1="478.8047" y2="478.8047"/><ellipse cx="383.5" cy="489.8047" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="475" x="392.5" y="493.0151">CosScanner(CosClient, Collection&lt;String&gt;, DataAccess, Set&lt;FileType&gt;, String, int)</text><ellipse cx="383.5" cy="502.6094" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="56" x="392.5" y="505.8198">init(): void</text><ellipse cx="383.5" cy="515.4141" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="99" x="392.5" y="518.6245">signalStop(): void</text><ellipse cx="383.5" cy="528.2188" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="106" x="392.5" y="531.4292">waitForStop(): void</text><ellipse cx="383.5" cy="541.0234" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="94" x="392.5" y="544.2339">mainLoop(): void</text><polygon fill="#FFFF44" points="383.5,548.8281,387.5,552.8281,383.5,556.8281,379.5,552.8281" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="120" x="392.5" y="557.0386">safeSleep(long): void</text><polygon fill="#FFFF44" points="383.5,561.6328,387.5,565.6328,383.5,569.6328,379.5,565.6328" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="66" x="392.5" y="569.8433">scan(): void</text><polygon fill="#FFFF44" points="383.5,574.4375,387.5,578.4375,383.5,582.4375,379.5,578.4375" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="145" x="392.5" y="582.6479">fileTyper(String): FileType</text><polygon fill="#FFFF44" points="383.5,587.2422,387.5,591.2422,383.5,595.2422,379.5,591.2422" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="124" x="392.5" y="595.4526">handle(CosItem): void</text><polygon fill="#FFFF44" points="383.5,600.0469,387.5,604.0469,383.5,608.0469,379.5,604.0469" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="94" x="392.5" y="608.2573">heartbeat(): void</text></a><!--MD5=[434e0b04adee20dec453537cb4a35e44]
class com.ibm.fhir.bucket.scanner.NoCloseInputStream--><a href="NoCloseInputStream.html" target="_top" title="NoCloseInputStream.html" xlink:actuate="onRequest" xlink:href="NoCloseInputStream.html" xlink:show="new" xlink:title="NoCloseInputStream.html" xlink:type="simple"><rect fill="#FEFECE" filter="url(#f16j4sa1a5as3o)" height="73.6094" id="com.ibm.fhir.bucket.scanner.NoCloseInputStream" style="stroke: #A80036; stroke-width: 1.5;" width="221" x="330.5" y="234.5"/><ellipse cx="372.95" cy="250.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M375.9188,256.1406 Q375.3406,256.4375 374.7,256.5781 Q374.0594,256.7344 373.3563,256.7344 Q370.8563,256.7344 369.5281,255.0938 Q368.2156,253.4375 368.2156,250.3125 Q368.2156,247.1875 369.5281,245.5313 Q370.8563,243.875 373.3563,243.875 Q374.0594,243.875 374.7,244.0313 Q375.3563,244.1875 375.9188,244.4844 L375.9188,247.2031 Q375.2938,246.625 374.7,246.3594 Q374.1063,246.0781 373.4813,246.0781 Q372.1375,246.0781 371.45,247.1563 Q370.7625,248.2188 370.7625,250.3125 Q370.7625,252.4063 371.45,253.4844 Q372.1375,254.5469 373.4813,254.5469 Q374.1063,254.5469 374.7,254.2813 Q375.2938,254 375.9188,253.4219 L375.9188,256.1406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="128" x="393.05" y="254.6543">NoCloseInputStream</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="331.5" x2="550.5" y1="266.5" y2="266.5"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="331.5" x2="550.5" y1="274.5" y2="274.5"/><ellipse cx="341.5" cy="285.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="195" x="350.5" y="288.7104">NoCloseInputStream(InputStream)</text><ellipse cx="341.5" cy="298.3047" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="69" x="350.5" y="301.5151">close(): void</text></a><!--MD5=[2f2d3ee6dd4278a22c433ffa5b3f9e3c]
class com.ibm.fhir.bucket.scanner.CosReader--><a href="CosReader.html" target="_top" title="CosReader.html" xlink:actuate="onRequest" xlink:href="CosReader.html" xlink:show="new" xlink:title="CosReader.html" xlink:type="simple"><rect fill="#FEFECE" filter="url(#f16j4sa1a5as3o)" height="176.0469" id="com.ibm.fhir.bucket.scanner.CosReader" style="stroke: #A80036; stroke-width: 1.5;" width="716" x="909" y="432.5"/><ellipse cx="1228.75" cy="448.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1231.7188,454.1406 Q1231.1406,454.4375 1230.5,454.5781 Q1229.8594,454.7344 1229.1563,454.7344 Q1226.6563,454.7344 1225.3281,453.0938 Q1224.0156,451.4375 1224.0156,448.3125 Q1224.0156,445.1875 1225.3281,443.5313 Q1226.6563,441.875 1229.1563,441.875 Q1229.8594,441.875 1230.5,442.0313 Q1231.1563,442.1875 1231.7188,442.4844 L1231.7188,445.2031 Q1231.0938,444.625 1230.5,444.3594 Q1229.9063,444.0781 1229.2813,444.0781 Q1227.9375,444.0781 1227.25,445.1563 Q1226.5625,446.2188 1226.5625,448.3125 Q1226.5625,450.4063 1227.25,451.4844 Q1227.9375,452.5469 1229.2813,452.5469 Q1229.9063,452.5469 1230.5,452.2813 Q1231.0938,452 1231.7188,451.4219 L1231.7188,454.1406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="68" x="1249.25" y="452.6543">CosReader</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="910" x2="1624" y1="464.5" y2="464.5"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="910" x2="1624" y1="472.5" y2="472.5"/><ellipse cx="920" cy="483.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="690" x="929" y="486.7104">CosReader(ExecutorService, FileType, CosClient, Consumer&lt;ResourceEntry&gt;, int, DataAccess, boolean, int, boolean, int)</text><ellipse cx="920" cy="496.3047" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="99" x="929" y="499.5151">signalStop(): void</text><ellipse cx="920" cy="509.1094" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="106" x="929" y="512.3198">waitForStop(): void</text><ellipse cx="920" cy="521.9141" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="56" x="929" y="525.1245">init(): void</text><ellipse cx="920" cy="534.7188" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="148" x="929" y="537.9292">mainAllocationLoop(): void</text><polygon fill="#FFFF44" points="920,542.5234,924,546.5234,920,550.5234,916,546.5234" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="120" x="929" y="550.7339">safeSleep(long): void</text><polygon fill="#FFFF44" points="920,555.3281,924,559.3281,920,563.3281,916,559.3281" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="208" x="929" y="563.5386">markJobDone(BucketLoaderJob): void</text><ellipse cx="920" cy="573.1328" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="320" x="929" y="576.3433">processNDJSON(BucketLoaderJob, BufferedReader): void</text><polygon fill="#FFFF44" points="920,580.9375,924,584.9375,920,588.9375,916,584.9375" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="326" x="929" y="589.1479">process(BucketLoaderJob, Resource, int, String): boolean</text><ellipse cx="920" cy="598.7422" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="210" x="929" y="601.9526">validateInput(Resource): List&lt;Issue&gt;</text></a><!--MD5=[dbdff8a2fae6c321988998aab8ea5b0a]
class com.ibm.fhir.bucket.scanner.Sha256InputStreamDecorator--><a href="Sha256InputStreamDecorator.html" target="_top" title="Sha256InputStreamDecorator.html" xlink:actuate="onRequest" xlink:href="Sha256InputStreamDecorator.html" xlink:show="new" xlink:title="Sha256InputStreamDecorator.html" xlink:type="simple"><rect fill="#FEFECE" filter="url(#f16j4sa1a5as3o)" height="112.0234" id="com.ibm.fhir.bucket.scanner.Sha256InputStreamDecorator" style="stroke: #A80036; stroke-width: 1.5;" width="273" x="22.5" y="215.5"/><ellipse cx="61.35" cy="231.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M64.3188,237.1406 Q63.7406,237.4375 63.1,237.5781 Q62.4594,237.7344 61.7563,237.7344 Q59.2563,237.7344 57.9281,236.0938 Q56.6156,234.4375 56.6156,231.3125 Q56.6156,228.1875 57.9281,226.5313 Q59.2563,224.875 61.7563,224.875 Q62.4594,224.875 63.1,225.0313 Q63.7563,225.1875 64.3188,225.4844 L64.3188,228.2031 Q63.6938,227.625 63.1,227.3594 Q62.5063,227.0781 61.8813,227.0781 Q60.5375,227.0781 59.85,228.1563 Q59.1625,229.2188 59.1625,231.3125 Q59.1625,233.4063 59.85,234.4844 Q60.5375,235.5469 61.8813,235.5469 Q62.5063,235.5469 63.1,235.2813 Q63.6938,235 64.3188,234.4219 L64.3188,237.1406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="188" x="80.65" y="235.6543">Sha256InputStreamDecorator</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="23.5" x2="294.5" y1="247.5" y2="247.5"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="23.5" x2="294.5" y1="255.5" y2="255.5"/><ellipse cx="33.5" cy="266.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="247" x="42.5" y="269.7104">Sha256InputStreamDecorator(InputStream)</text><ellipse cx="33.5" cy="279.3047" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="140" x="42.5" y="282.5151">getBase64Hash(): String</text><ellipse cx="33.5" cy="292.1094" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="56" x="42.5" y="295.3198">read(): int</text><ellipse cx="33.5" cy="304.9141" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="132" x="42.5" y="308.1245">read(byte[], int, int): int</text><ellipse cx="33.5" cy="317.7188" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="69" x="42.5" y="320.9292">close(): void</text></a><!--MD5=[7bc894eae69de9994c6e46ebc6cb7767]
class java.io.PushbackInputStream--><a href="https://docs.oracle.com/javase/8/docs/api/java/io/PushbackInputStream.html?is-external=true" target="_top" title="https://docs.oracle.com/javase/8/docs/api/java/io/PushbackInputStream.html?is-external=true" xlink:actuate="onRequest" xlink:href="https://docs.oracle.com/javase/8/docs/api/java/io/PushbackInputStream.html?is-external=true" xlink:show="new" xlink:title="https://docs.oracle.com/javase/8/docs/api/java/io/PushbackInputStream.html?is-external=true" xlink:type="simple"><rect fill="#FEFECE" filter="url(#f16j4sa1a5as3o)" height="73.6094" id="java.io.PushbackInputStream" style="stroke: #A80036; stroke-width: 1.5;" width="170" x="302" y="43"/><ellipse cx="317" cy="59" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M319.9688,64.6406 Q319.3906,64.9375 318.75,65.0781 Q318.1094,65.2344 317.4063,65.2344 Q314.9063,65.2344 313.5781,63.5938 Q312.2656,61.9375 312.2656,58.8125 Q312.2656,55.6875 313.5781,54.0313 Q314.9063,52.375 317.4063,52.375 Q318.1094,52.375 318.75,52.5313 Q319.4063,52.6875 319.9688,52.9844 L319.9688,55.7031 Q319.3438,55.125 318.75,54.8594 Q318.1563,54.5781 317.5313,54.5781 Q316.1875,54.5781 315.5,55.6563 Q314.8125,56.7188 314.8125,58.8125 Q314.8125,60.9063 315.5,61.9844 Q316.1875,63.0469 317.5313,63.0469 Q318.1563,63.0469 318.75,62.7813 Q319.3438,62.5 319.9688,61.9219 L319.9688,64.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="138" x="331" y="63.1543">PushbackInputStream</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="303" x2="471" y1="75" y2="75"/><polygon fill="none" points="313,81,317,85,313,89,309,85" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="58" x="322" y="89.2104">buf: byte[]</text><polygon fill="none" points="313,93.8047,317,97.8047,313,101.8047,309,97.8047" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="43" x="322" y="102.0151">pos: int</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="303" x2="471" y1="108.6094" y2="108.6094"/></a><!--MD5=[fa9a3b769145f837d7bc2faadf88dde7]
class java.io.InputStream--><a href="https://docs.oracle.com/javase/8/docs/api/java/io/InputStream.html?is-external=true" target="_top" title="https://docs.oracle.com/javase/8/docs/api/java/io/InputStream.html?is-external=true" xlink:actuate="onRequest" xlink:href="https://docs.oracle.com/javase/8/docs/api/java/io/InputStream.html?is-external=true" xlink:show="new" xlink:title="https://docs.oracle.com/javase/8/docs/api/java/io/InputStream.html?is-external=true" xlink:type="simple"><rect fill="#FEFECE" filter="url(#f16j4sa1a5as3o)" height="60.8047" id="java.io.InputStream" style="stroke: #A80036; stroke-width: 1.5;" width="109" x="157.5" y="49.5"/><ellipse cx="172.5" cy="65.5" fill="#A9DCDF" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M172.6094,60.8438 L171.4531,65.9219 L173.7813,65.9219 L172.6094,60.8438 Z M171.125,58.6094 L174.1094,58.6094 L177.4688,71 L175.0156,71 L174.25,67.9375 L170.9688,67.9375 L170.2188,71 L167.7813,71 L171.125,58.6094 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="77" x="186.5" y="69.6543">InputStream</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="158.5" x2="265.5" y1="81.5" y2="81.5"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="158.5" x2="265.5" y1="89.5" y2="89.5"/><ellipse cx="168.5" cy="100.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="56" x="177.5" y="103.7104">read(): int</text></a><!--MD5=[99ab7726ceb1317eb372bc9558f40dad]
reverse link java.io.PushbackInputStream to com.ibm.fhir.bucket.scanner.NoCloseInputStream--><path d="M403.045,136.9005 C411.9165,168.3614 422.6882,206.5609 430.4866,234.2165 " fill="none" id="java.io.PushbackInputStream&lt;-com.ibm.fhir.bucket.scanner.NoCloseInputStream" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="396.2307,138.5269,397.5399,117.3777,409.7053,134.7272,396.2307,138.5269" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[869ba41b732a6c73c189fc634a550b36]
reverse link java.io.InputStream to com.ibm.fhir.bucket.scanner.Sha256InputStreamDecorator--><path d="M198.0939,130.2457 C190.8642,156.368 182.005,188.3781 174.5492,215.3175 " fill="none" id="java.io.InputStream&lt;-com.ibm.fhir.bucket.scanner.Sha256InputStreamDecorator" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="191.4035,128.176,203.4846,110.7678,204.8962,131.9104,191.4035,128.176" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[e75ae7ddb016c2b7424b0651c3834158]
link com.ibm.fhir.bucket.scanner.DataAccess to com.ibm.fhir.bucket.scanner.LoaderQueue--><!--MD5=[35497b7245a8c320f80f882a19199347]
link com.ibm.fhir.bucket.scanner.LoaderQueue to com.ibm.fhir.bucket.scanner.ResourceHandler--><!--MD5=[a94c5f69aa62816211e06286fd755664]
link com.ibm.fhir.bucket.scanner.DataAccess to com.ibm.fhir.bucket.scanner.CosScanner--><!--MD5=[3735991b33d035d5365336686a96b8d9]
link com.ibm.fhir.bucket.scanner.CosScanner to com.ibm.fhir.bucket.scanner.CosReader--><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="186" x="736.5" y="650.2822">UMLDoclet 2.0.7, PlantUML 1.2019.12</text><!--MD5=[e851201143369db64743d0c9193e2d9b]
@startuml
    namespace com.ibm.fhir.bucket.scanner {

        class DataAccess [[DataAccess.html]] {
            +DataAccess(IDatabaseAdapter, ITransactionProvider, String)
            +init(): void
            +registerBucketItem(CosItem): void
            +allocateJobs(List<BucketLoaderJob>, FileType, int, int): void
            +recordLogicalId(String, String, long, int, Integer): void
            +heartbeat(): void
            +markJobDone(BucketLoaderJob): void
            +recordLogicalIds(long, int, List<ResourceIdValue>, int): void
            +recordErrors(long, int, List<ResourceBundleError>): void
            +getLastProcessedLineNumber(long, int): Integer
            +getResourceRefsForLine(long, int, int): List<ResourceRef>
        }

        interface LoaderQueue [[LoaderQueue.html]] {
            {abstract} +processEntry(String, String): void
        }

        class ResourceHandler [[ResourceHandler.html]] {
            +ResourceHandler(ExecutorService, int, FhirClient, DataAccess)
            +signalStop(): void
            +waitForStop(): void
            +process(ResourceEntry): boolean
            +processThr(ResourceEntry): void
            #processBadRequest(ResourceEntry, FhirServerResponse): void
            +init(): void
        }

        class CosScanner [[CosScanner.html]] {
            {static} +HEARTBEAT_INTERVAL_MS: long
            +CosScanner(CosClient, Collection<String>, DataAccess, Set<FileType>, String, int)
            +init(): void
            +signalStop(): void
            +waitForStop(): void
            +mainLoop(): void
            #safeSleep(long): void
            #scan(): void
            {static} #fileTyper(String): FileType
            #handle(CosItem): void
            #heartbeat(): void
        }

        class NoCloseInputStream [[NoCloseInputStream.html]] {
            +NoCloseInputStream(InputStream)
            +close(): void
        }

        class CosReader [[CosReader.html]] {
            +CosReader(ExecutorService, FileType, CosClient, Consumer<ResourceEntry>, int, DataAccess, boolean, int, boolean, int)
            +signalStop(): void
            +waitForStop(): void
            +init(): void
            +mainAllocationLoop(): void
            #safeSleep(long): void
            #markJobDone(BucketLoaderJob): void
            +processNDJSON(BucketLoaderJob, BufferedReader): void
            #process(BucketLoaderJob, Resource, int, String): boolean
            +validateInput(Resource): List<Issue>
        }

        class Sha256InputStreamDecorator [[Sha256InputStreamDecorator.html]] {
            +Sha256InputStreamDecorator(InputStream)
            +getBase64Hash(): String
            +read(): int
            +read(byte[], int, int): int
            +close(): void
        }

        java.io.PushbackInputStream <|- - NoCloseInputStream
        java.io.InputStream <|- - Sha256InputStreamDecorator
    }

    namespace java.io {
        class PushbackInputStream [[https://docs.oracle.com/javase/8/docs/api/java/io/PushbackInputStream.html?is-external=true]] {
            #buf: byte[]
            #pos: int
        }
        abstract class InputStream [[https://docs.oracle.com/javase/8/docs/api/java/io/InputStream.html?is-external=true]] {
            {abstract} +read(): int
        }
    }

    center footer UMLDoclet 2.0.7, PlantUML 1.2019.12
@enduml

PlantUML version 1.2019.12(Sun Nov 03 10:24:54 UTC 2019)
(APACHE source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.8+10
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>