<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="663px" preserveAspectRatio="none" style="width:2289px;height:663px;" version="1.1" viewBox="0 0 2289 663" width="2289px" zoomAndPan="magnify"><defs><filter height="300%" id="f1c1o1dc3a14zy" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--MD5=[b0d9575ab999429b72cc019b4a2a88d8]
cluster com.ibm.fhir.bucket.scanner--><polygon fill="#FFFFFF" filter="url(#f1c1o1dc3a14zy)" points="14,150,246,150,253,172.2969,2267,172.2969,2267,623,14,623,14,150" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="14" x2="253" y1="172.2969" y2="172.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="226" x="18" y="164.9951">com.ibm.fhir.bucket.scanner</text><!--MD5=[0d852700fdad35b7061d461d6907a324]
cluster java.io--><polygon fill="#FFFFFF" filter="url(#f1c1o1dc3a14zy)" points="149,16,205,16,212,38.2969,480,38.2969,480,125,149,125,149,16" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="149" x2="212" y1="38.2969" y2="38.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="50" x="153" y="30.9951">java.io</text><!--MD5=[434e0b04adee20dec453537cb4a35e44]
class com.ibm.fhir.bucket.scanner.NoCloseInputStream--><a href="NoCloseInputStream.html" target="_top" title="NoCloseInputStream.html" xlink:actuate="onRequest" xlink:href="NoCloseInputStream.html" xlink:show="new" xlink:title="NoCloseInputStream.html" xlink:type="simple"><rect fill="#FEFECE" filter="url(#f1c1o1dc3a14zy)" height="73.6094" id="com.ibm.fhir.bucket.scanner.NoCloseInputStream" style="stroke: #A80036; stroke-width: 1.5;" width="221" x="330.5" y="234.5"/><ellipse cx="372.95" cy="250.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M375.9188,256.1406 Q375.3406,256.4375 374.7,256.5781 Q374.0594,256.7344 373.3563,256.7344 Q370.8563,256.7344 369.5281,255.0938 Q368.2156,253.4375 368.2156,250.3125 Q368.2156,247.1875 369.5281,245.5313 Q370.8563,243.875 373.3563,243.875 Q374.0594,243.875 374.7,244.0313 Q375.3563,244.1875 375.9188,244.4844 L375.9188,247.2031 Q375.2938,246.625 374.7,246.3594 Q374.1063,246.0781 373.4813,246.0781 Q372.1375,246.0781 371.45,247.1563 Q370.7625,248.2188 370.7625,250.3125 Q370.7625,252.4063 371.45,253.4844 Q372.1375,254.5469 373.4813,254.5469 Q374.1063,254.5469 374.7,254.2813 Q375.2938,254 375.9188,253.4219 L375.9188,256.1406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="128" x="393.05" y="254.6543">NoCloseInputStream</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="331.5" x2="550.5" y1="266.5" y2="266.5"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="331.5" x2="550.5" y1="274.5" y2="274.5"/><ellipse cx="341.5" cy="285.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="195" x="350.5" y="288.7104">NoCloseInputStream(InputStream)</text><ellipse cx="341.5" cy="298.3047" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="69" x="350.5" y="301.5151">close(): void</text></a><!--MD5=[2f2d3ee6dd4278a22c433ffa5b3f9e3c]
class com.ibm.fhir.bucket.scanner.CosReader--><a href="CosReader.html" target="_top" title="CosReader.html" xlink:actuate="onRequest" xlink:href="CosReader.html" xlink:show="new" xlink:title="CosReader.html" xlink:type="simple"><rect fill="#FEFECE" filter="url(#f1c1o1dc3a14zy)" height="176.0469" id="com.ibm.fhir.bucket.scanner.CosReader" style="stroke: #A80036; stroke-width: 1.5;" width="716" x="587" y="183.5"/><ellipse cx="906.75" cy="199.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M909.7188,205.1406 Q909.1406,205.4375 908.5,205.5781 Q907.8594,205.7344 907.1563,205.7344 Q904.6563,205.7344 903.3281,204.0938 Q902.0156,202.4375 902.0156,199.3125 Q902.0156,196.1875 903.3281,194.5313 Q904.6563,192.875 907.1563,192.875 Q907.8594,192.875 908.5,193.0313 Q909.1563,193.1875 909.7188,193.4844 L909.7188,196.2031 Q909.0938,195.625 908.5,195.3594 Q907.9063,195.0781 907.2813,195.0781 Q905.9375,195.0781 905.25,196.1563 Q904.5625,197.2188 904.5625,199.3125 Q904.5625,201.4063 905.25,202.4844 Q905.9375,203.5469 907.2813,203.5469 Q907.9063,203.5469 908.5,203.2813 Q909.0938,203 909.7188,202.4219 L909.7188,205.1406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="68" x="927.25" y="203.6543">CosReader</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="588" x2="1302" y1="215.5" y2="215.5"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="588" x2="1302" y1="223.5" y2="223.5"/><ellipse cx="598" cy="234.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="690" x="607" y="237.7104">CosReader(ExecutorService, FileType, CosClient, Consumer&lt;ResourceEntry&gt;, int, DataAccess, boolean, int, boolean, int)</text><ellipse cx="598" cy="247.3047" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="99" x="607" y="250.5151">signalStop(): void</text><ellipse cx="598" cy="260.1094" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="106" x="607" y="263.3198">waitForStop(): void</text><ellipse cx="598" cy="272.9141" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="56" x="607" y="276.1245">init(): void</text><ellipse cx="598" cy="285.7188" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="148" x="607" y="288.9292">mainAllocationLoop(): void</text><polygon fill="#FFFF44" points="598,293.5234,602,297.5234,598,301.5234,594,297.5234" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="120" x="607" y="301.7339">safeSleep(long): void</text><polygon fill="#FFFF44" points="598,306.3281,602,310.3281,598,314.3281,594,310.3281" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="208" x="607" y="314.5386">markJobDone(BucketLoaderJob): void</text><ellipse cx="598" cy="324.1328" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="320" x="607" y="327.3433">processNDJSON(BucketLoaderJob, BufferedReader): void</text><polygon fill="#FFFF44" points="598,331.9375,602,335.9375,598,339.9375,594,335.9375" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="326" x="607" y="340.1479">process(BucketLoaderJob, Resource, int, String): boolean</text><ellipse cx="598" cy="349.7422" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="210" x="607" y="352.9526">validateInput(Resource): List&lt;Issue&gt;</text></a><!--MD5=[bb92dc037dab9e7188241d686cc36a7e]
class com.ibm.fhir.bucket.scanner.ResourceHandler--><a href="ResourceHandler.html" target="_top" title="ResourceHandler.html" xlink:actuate="onRequest" xlink:href="ResourceHandler.html" xlink:show="new" xlink:title="ResourceHandler.html" xlink:type="simple"><rect fill="#FEFECE" filter="url(#f1c1o1dc3a14zy)" height="137.6328" id="com.ibm.fhir.bucket.scanner.ResourceHandler" style="stroke: #A80036; stroke-width: 1.5;" width="384" x="1338" y="202.5"/><ellipse cx="1471.75" cy="218.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1474.7188,224.1406 Q1474.1406,224.4375 1473.5,224.5781 Q1472.8594,224.7344 1472.1563,224.7344 Q1469.6563,224.7344 1468.3281,223.0938 Q1467.0156,221.4375 1467.0156,218.3125 Q1467.0156,215.1875 1468.3281,213.5313 Q1469.6563,211.875 1472.1563,211.875 Q1472.8594,211.875 1473.5,212.0313 Q1474.1563,212.1875 1474.7188,212.4844 L1474.7188,215.2031 Q1474.0938,214.625 1473.5,214.3594 Q1472.9063,214.0781 1472.2813,214.0781 Q1470.9375,214.0781 1470.25,215.1563 Q1469.5625,216.2188 1469.5625,218.3125 Q1469.5625,220.4063 1470.25,221.4844 Q1470.9375,222.5469 1472.2813,222.5469 Q1472.9063,222.5469 1473.5,222.2813 Q1474.0938,222 1474.7188,221.4219 L1474.7188,224.1406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="108" x="1492.25" y="222.6543">ResourceHandler</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1339" x2="1721" y1="234.5" y2="234.5"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="1339" x2="1721" y1="242.5" y2="242.5"/><ellipse cx="1349" cy="253.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="353" x="1358" y="256.7104">ResourceHandler(ExecutorService, int, FhirClient, DataAccess)</text><ellipse cx="1349" cy="266.3047" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="99" x="1358" y="269.5151">signalStop(): void</text><ellipse cx="1349" cy="279.1094" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="106" x="1358" y="282.3198">waitForStop(): void</text><ellipse cx="1349" cy="291.9141" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="189" x="1358" y="295.1245">process(ResourceEntry): boolean</text><ellipse cx="1349" cy="304.7188" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="186" x="1358" y="307.9292">processThr(ResourceEntry): void</text><polygon fill="#FFFF44" points="1349,312.5234,1353,316.5234,1349,320.5234,1345,316.5234" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="358" x="1358" y="320.7339">processBadRequest(ResourceEntry, FhirServerResponse): void</text><ellipse cx="1349" cy="330.3281" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="56" x="1358" y="333.5386">init(): void</text></a><!--MD5=[117b4744d87af26d6202ac4a9292f012]
class com.ibm.fhir.bucket.scanner.CosScanner--><a href="CosScanner.html" target="_top" title="CosScanner.html" xlink:actuate="onRequest" xlink:href="CosScanner.html" xlink:show="new" xlink:title="CosScanner.html" xlink:type="simple"><rect fill="#FEFECE" filter="url(#f1c1o1dc3a14zy)" height="188.8516" id="com.ibm.fhir.bucket.scanner.CosScanner" style="stroke: #A80036; stroke-width: 1.5;" width="501" x="1757.5" y="177"/><ellipse cx="1966.25" cy="193" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1969.2188,198.6406 Q1968.6406,198.9375 1968,199.0781 Q1967.3594,199.2344 1966.6563,199.2344 Q1964.1563,199.2344 1962.8281,197.5938 Q1961.5156,195.9375 1961.5156,192.8125 Q1961.5156,189.6875 1962.8281,188.0313 Q1964.1563,186.375 1966.6563,186.375 Q1967.3594,186.375 1968,186.5313 Q1968.6563,186.6875 1969.2188,186.9844 L1969.2188,189.7031 Q1968.5938,189.125 1968,188.8594 Q1967.4063,188.5781 1966.7813,188.5781 Q1965.4375,188.5781 1964.75,189.6563 Q1964.0625,190.7188 1964.0625,192.8125 Q1964.0625,194.9063 1964.75,195.9844 Q1965.4375,197.0469 1966.7813,197.0469 Q1967.4063,197.0469 1968,196.7813 Q1968.5938,196.5 1969.2188,195.9219 L1969.2188,198.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="75" x="1986.75" y="197.1543">CosScanner</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1758.5" x2="2257.5" y1="209" y2="209"/><ellipse cx="1768.5" cy="220" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="178" x="1777.5" y="223.2104">HEARTBEAT_INTERVAL_MS: long</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1758.5" x2="2257.5" y1="229.8047" y2="229.8047"/><ellipse cx="1768.5" cy="240.8047" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="475" x="1777.5" y="244.0151">CosScanner(CosClient, Collection&lt;String&gt;, DataAccess, Set&lt;FileType&gt;, String, int)</text><ellipse cx="1768.5" cy="253.6094" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="56" x="1777.5" y="256.8198">init(): void</text><ellipse cx="1768.5" cy="266.4141" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="99" x="1777.5" y="269.6245">signalStop(): void</text><ellipse cx="1768.5" cy="279.2188" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="106" x="1777.5" y="282.4292">waitForStop(): void</text><ellipse cx="1768.5" cy="292.0234" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="94" x="1777.5" y="295.2339">mainLoop(): void</text><polygon fill="#FFFF44" points="1768.5,299.8281,1772.5,303.8281,1768.5,307.8281,1764.5,303.8281" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="120" x="1777.5" y="308.0386">safeSleep(long): void</text><polygon fill="#FFFF44" points="1768.5,312.6328,1772.5,316.6328,1768.5,320.6328,1764.5,316.6328" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="66" x="1777.5" y="320.8433">scan(): void</text><polygon fill="#FFFF44" points="1768.5,325.4375,1772.5,329.4375,1768.5,333.4375,1764.5,329.4375" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="145" x="1777.5" y="333.6479">fileTyper(String): FileType</text><polygon fill="#FFFF44" points="1768.5,338.2422,1772.5,342.2422,1768.5,346.2422,1764.5,342.2422" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="124" x="1777.5" y="346.4526">handle(CosItem): void</text><polygon fill="#FFFF44" points="1768.5,351.0469,1772.5,355.0469,1768.5,359.0469,1764.5,355.0469" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="94" x="1777.5" y="359.2573">heartbeat(): void</text></a><!--MD5=[dbdff8a2fae6c321988998aab8ea5b0a]
class com.ibm.fhir.bucket.scanner.Sha256InputStreamDecorator--><a href="Sha256InputStreamDecorator.html" target="_top" title="Sha256InputStreamDecorator.html" xlink:actuate="onRequest" xlink:href="Sha256InputStreamDecorator.html" xlink:show="new" xlink:title="Sha256InputStreamDecorator.html" xlink:type="simple"><rect fill="#FEFECE" filter="url(#f1c1o1dc3a14zy)" height="112.0234" id="com.ibm.fhir.bucket.scanner.Sha256InputStreamDecorator" style="stroke: #A80036; stroke-width: 1.5;" width="273" x="22.5" y="215.5"/><ellipse cx="61.35" cy="231.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M64.3188,237.1406 Q63.7406,237.4375 63.1,237.5781 Q62.4594,237.7344 61.7563,237.7344 Q59.2563,237.7344 57.9281,236.0938 Q56.6156,234.4375 56.6156,231.3125 Q56.6156,228.1875 57.9281,226.5313 Q59.2563,224.875 61.7563,224.875 Q62.4594,224.875 63.1,225.0313 Q63.7563,225.1875 64.3188,225.4844 L64.3188,228.2031 Q63.6938,227.625 63.1,227.3594 Q62.5063,227.0781 61.8813,227.0781 Q60.5375,227.0781 59.85,228.1563 Q59.1625,229.2188 59.1625,231.3125 Q59.1625,233.4063 59.85,234.4844 Q60.5375,235.5469 61.8813,235.5469 Q62.5063,235.5469 63.1,235.2813 Q63.6938,235 64.3188,234.4219 L64.3188,237.1406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="188" x="80.65" y="235.6543">Sha256InputStreamDecorator</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="23.5" x2="294.5" y1="247.5" y2="247.5"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="23.5" x2="294.5" y1="255.5" y2="255.5"/><ellipse cx="33.5" cy="266.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="247" x="42.5" y="269.7104">Sha256InputStreamDecorator(InputStream)</text><ellipse cx="33.5" cy="279.3047" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="140" x="42.5" y="282.5151">getBase64Hash(): String</text><ellipse cx="33.5" cy="292.1094" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="56" x="42.5" y="295.3198">read(): int</text><ellipse cx="33.5" cy="304.9141" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="132" x="42.5" y="308.1245">read(byte[], int, int): int</text><ellipse cx="33.5" cy="317.7188" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="69" x="42.5" y="320.9292">close(): void</text></a><!--MD5=[0e3cd8e43eee1ca12f784a2afaf30c31]
class com.ibm.fhir.bucket.scanner.DataAccess--><a href="DataAccess.html" target="_top" title="DataAccess.html" xlink:actuate="onRequest" xlink:href="DataAccess.html" xlink:show="new" xlink:title="DataAccess.html" xlink:type="simple"><rect fill="#FEFECE" filter="url(#f1c1o1dc3a14zy)" height="188.8516" id="com.ibm.fhir.bucket.scanner.DataAccess" style="stroke: #A80036; stroke-width: 1.5;" width="368" x="761" y="426"/><ellipse cx="903.75" cy="442" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M906.7188,447.6406 Q906.1406,447.9375 905.5,448.0781 Q904.8594,448.2344 904.1563,448.2344 Q901.6563,448.2344 900.3281,446.5938 Q899.0156,444.9375 899.0156,441.8125 Q899.0156,438.6875 900.3281,437.0313 Q901.6563,435.375 904.1563,435.375 Q904.8594,435.375 905.5,435.5313 Q906.1563,435.6875 906.7188,435.9844 L906.7188,438.7031 Q906.0938,438.125 905.5,437.8594 Q904.9063,437.5781 904.2813,437.5781 Q902.9375,437.5781 902.25,438.6563 Q901.5625,439.7188 901.5625,441.8125 Q901.5625,443.9063 902.25,444.9844 Q902.9375,446.0469 904.2813,446.0469 Q904.9063,446.0469 905.5,445.7813 Q906.0938,445.5 906.7188,444.9219 L906.7188,447.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="74" x="924.25" y="446.1543">DataAccess</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="762" x2="1128" y1="458" y2="458"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="762" x2="1128" y1="466" y2="466"/><ellipse cx="772" cy="477" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="342" x="781" y="480.2104">DataAccess(IDatabaseAdapter, ITransactionProvider, String)</text><ellipse cx="772" cy="489.8047" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="56" x="781" y="493.0151">init(): void</text><ellipse cx="772" cy="502.6094" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="194" x="781" y="505.8198">registerBucketItem(CosItem): void</text><ellipse cx="772" cy="515.4141" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="337" x="781" y="518.6245">allocateJobs(List&lt;BucketLoaderJob&gt;, FileType, int, int): void</text><ellipse cx="772" cy="528.2188" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="303" x="781" y="531.4292">recordLogicalId(String, String, long, int, Integer): void</text><ellipse cx="772" cy="541.0234" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="94" x="781" y="544.2339">heartbeat(): void</text><ellipse cx="772" cy="553.8281" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="208" x="781" y="557.0386">markJobDone(BucketLoaderJob): void</text><ellipse cx="772" cy="566.6328" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="340" x="781" y="569.8433">recordLogicalIds(long, int, List&lt;ResourceIdValue&gt;, int): void</text><ellipse cx="772" cy="579.4375" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="325" x="781" y="582.6479">recordErrors(long, int, List&lt;ResourceBundleError&gt;): void</text><ellipse cx="772" cy="592.2422" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="272" x="781" y="595.4526">getLastProcessedLineNumber(long, int): Integer</text><ellipse cx="772" cy="605.0469" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="330" x="781" y="608.2573">getResourceRefsForLine(long, int, int): List&lt;ResourceRef&gt;</text></a><!--MD5=[5da28120c68ca992e1f1d65bc7d035a4]
class com.ibm.fhir.bucket.scanner.LoaderQueue--><a href="LoaderQueue.html" target="_top" title="LoaderQueue.html" xlink:actuate="onRequest" xlink:href="LoaderQueue.html" xlink:show="new" xlink:title="LoaderQueue.html" xlink:type="simple"><rect fill="#FEFECE" filter="url(#f1c1o1dc3a14zy)" height="60.8047" id="com.ibm.fhir.bucket.scanner.LoaderQueue" style="stroke: #A80036; stroke-width: 1.5;" width="216" x="1164" y="490"/><ellipse cx="1225.75" cy="506" fill="#B4A7E5" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1221.6719,501.7656 L1221.6719,499.6094 L1229.0625,499.6094 L1229.0625,501.7656 L1226.5938,501.7656 L1226.5938,509.8438 L1229.0625,509.8438 L1229.0625,512 L1221.6719,512 L1221.6719,509.8438 L1224.1406,509.8438 L1224.1406,501.7656 L1221.6719,501.7656 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="84" x="1246.25" y="510.1543">LoaderQueue</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1165" x2="1379" y1="522" y2="522"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="1165" x2="1379" y1="530" y2="530"/><ellipse cx="1175" cy="541" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="190" x="1184" y="544.2104">processEntry(String, String): void</text></a><!--MD5=[7bc894eae69de9994c6e46ebc6cb7767]
class java.io.PushbackInputStream--><a href="https://docs.oracle.com/javase/8/docs/api/java/io/PushbackInputStream.html?is-external=true" target="_top" title="https://docs.oracle.com/javase/8/docs/api/java/io/PushbackInputStream.html?is-external=true" xlink:actuate="onRequest" xlink:href="https://docs.oracle.com/javase/8/docs/api/java/io/PushbackInputStream.html?is-external=true" xlink:show="new" xlink:title="https://docs.oracle.com/javase/8/docs/api/java/io/PushbackInputStream.html?is-external=true" xlink:type="simple"><rect fill="#FEFECE" filter="url(#f1c1o1dc3a14zy)" height="73.6094" id="java.io.PushbackInputStream" style="stroke: #A80036; stroke-width: 1.5;" width="170" x="302" y="43"/><ellipse cx="317" cy="59" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M319.9688,64.6406 Q319.3906,64.9375 318.75,65.0781 Q318.1094,65.2344 317.4063,65.2344 Q314.9063,65.2344 313.5781,63.5938 Q312.2656,61.9375 312.2656,58.8125 Q312.2656,55.6875 313.5781,54.0313 Q314.9063,52.375 317.4063,52.375 Q318.1094,52.375 318.75,52.5313 Q319.4063,52.6875 319.9688,52.9844 L319.9688,55.7031 Q319.3438,55.125 318.75,54.8594 Q318.1563,54.5781 317.5313,54.5781 Q316.1875,54.5781 315.5,55.6563 Q314.8125,56.7188 314.8125,58.8125 Q314.8125,60.9063 315.5,61.9844 Q316.1875,63.0469 317.5313,63.0469 Q318.1563,63.0469 318.75,62.7813 Q319.3438,62.5 319.9688,61.9219 L319.9688,64.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="138" x="331" y="63.1543">PushbackInputStream</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="303" x2="471" y1="75" y2="75"/><polygon fill="none" points="313,81,317,85,313,89,309,85" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="58" x="322" y="89.2104">buf: byte[]</text><polygon fill="none" points="313,93.8047,317,97.8047,313,101.8047,309,97.8047" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="43" x="322" y="102.0151">pos: int</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="303" x2="471" y1="108.6094" y2="108.6094"/></a><!--MD5=[fa9a3b769145f837d7bc2faadf88dde7]
class java.io.InputStream--><a href="https://docs.oracle.com/javase/8/docs/api/java/io/InputStream.html?is-external=true" target="_top" title="https://docs.oracle.com/javase/8/docs/api/java/io/InputStream.html?is-external=true" xlink:actuate="onRequest" xlink:href="https://docs.oracle.com/javase/8/docs/api/java/io/InputStream.html?is-external=true" xlink:show="new" xlink:title="https://docs.oracle.com/javase/8/docs/api/java/io/InputStream.html?is-external=true" xlink:type="simple"><rect fill="#FEFECE" filter="url(#f1c1o1dc3a14zy)" height="60.8047" id="java.io.InputStream" style="stroke: #A80036; stroke-width: 1.5;" width="109" x="157.5" y="49.5"/><ellipse cx="172.5" cy="65.5" fill="#A9DCDF" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M172.6094,60.8438 L171.4531,65.9219 L173.7813,65.9219 L172.6094,60.8438 Z M171.125,58.6094 L174.1094,58.6094 L177.4688,71 L175.0156,71 L174.25,67.9375 L170.9688,67.9375 L170.2188,71 L167.7813,71 L171.125,58.6094 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="77" x="186.5" y="69.6543">InputStream</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="158.5" x2="265.5" y1="81.5" y2="81.5"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="158.5" x2="265.5" y1="89.5" y2="89.5"/><ellipse cx="168.5" cy="100.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="56" x="177.5" y="103.7104">read(): int</text></a><!--MD5=[99ab7726ceb1317eb372bc9558f40dad]
reverse link java.io.PushbackInputStream to com.ibm.fhir.bucket.scanner.NoCloseInputStream--><path d="M403.045,136.9005 C411.9165,168.3614 422.6882,206.5609 430.4866,234.2165 " fill="none" id="java.io.PushbackInputStream&lt;-com.ibm.fhir.bucket.scanner.NoCloseInputStream" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="396.2307,138.5269,397.5399,117.3777,409.7053,134.7272,396.2307,138.5269" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[869ba41b732a6c73c189fc634a550b36]
reverse link java.io.InputStream to com.ibm.fhir.bucket.scanner.Sha256InputStreamDecorator--><path d="M198.0939,130.2457 C190.8642,156.368 182.005,188.3781 174.5492,215.3175 " fill="none" id="java.io.InputStream&lt;-com.ibm.fhir.bucket.scanner.Sha256InputStreamDecorator" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="191.4035,128.176,203.4846,110.7678,204.8962,131.9104,191.4035,128.176" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[b5f38ef8b2fc50db582b2d4281f95b2b]
link com.ibm.fhir.bucket.scanner.CosReader to com.ibm.fhir.bucket.scanner.ResourceHandler--><!--MD5=[9f08a380fbdfe3cca4970d93001a8320]
link com.ibm.fhir.bucket.scanner.ResourceHandler to com.ibm.fhir.bucket.scanner.CosScanner--><!--MD5=[b52cc67c374e51beb4b7f43ff23f0974]
link com.ibm.fhir.bucket.scanner.CosReader to com.ibm.fhir.bucket.scanner.DataAccess--><!--MD5=[e75ae7ddb016c2b7424b0651c3834158]
link com.ibm.fhir.bucket.scanner.DataAccess to com.ibm.fhir.bucket.scanner.LoaderQueue--><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="186" x="1053.5" y="650.2822">UMLDoclet 2.0.7, PlantUML 1.2019.12</text><!--MD5=[db3360119c989f5e5273656d961141b7]
@startuml
    namespace com.ibm.fhir.bucket.scanner {

        class NoCloseInputStream [[NoCloseInputStream.html]] {
            +NoCloseInputStream(InputStream)
            +close(): void
        }

        class CosReader [[CosReader.html]] {
            +CosReader(ExecutorService, FileType, CosClient, Consumer<ResourceEntry>, int, DataAccess, boolean, int, boolean, int)
            +signalStop(): void
            +waitForStop(): void
            +init(): void
            +mainAllocationLoop(): void
            #safeSleep(long): void
            #markJobDone(BucketLoaderJob): void
            +processNDJSON(BucketLoaderJob, BufferedReader): void
            #process(BucketLoaderJob, Resource, int, String): boolean
            +validateInput(Resource): List<Issue>
        }

        class ResourceHandler [[ResourceHandler.html]] {
            +ResourceHandler(ExecutorService, int, FhirClient, DataAccess)
            +signalStop(): void
            +waitForStop(): void
            +process(ResourceEntry): boolean
            +processThr(ResourceEntry): void
            #processBadRequest(ResourceEntry, FhirServerResponse): void
            +init(): void
        }

        class CosScanner [[CosScanner.html]] {
            {static} +HEARTBEAT_INTERVAL_MS: long
            +CosScanner(CosClient, Collection<String>, DataAccess, Set<FileType>, String, int)
            +init(): void
            +signalStop(): void
            +waitForStop(): void
            +mainLoop(): void
            #safeSleep(long): void
            #scan(): void
            {static} #fileTyper(String): FileType
            #handle(CosItem): void
            #heartbeat(): void
        }

        class Sha256InputStreamDecorator [[Sha256InputStreamDecorator.html]] {
            +Sha256InputStreamDecorator(InputStream)
            +getBase64Hash(): String
            +read(): int
            +read(byte[], int, int): int
            +close(): void
        }

        class DataAccess [[DataAccess.html]] {
            +DataAccess(IDatabaseAdapter, ITransactionProvider, String)
            +init(): void
            +registerBucketItem(CosItem): void
            +allocateJobs(List<BucketLoaderJob>, FileType, int, int): void
            +recordLogicalId(String, String, long, int, Integer): void
            +heartbeat(): void
            +markJobDone(BucketLoaderJob): void
            +recordLogicalIds(long, int, List<ResourceIdValue>, int): void
            +recordErrors(long, int, List<ResourceBundleError>): void
            +getLastProcessedLineNumber(long, int): Integer
            +getResourceRefsForLine(long, int, int): List<ResourceRef>
        }

        interface LoaderQueue [[LoaderQueue.html]] {
            {abstract} +processEntry(String, String): void
        }

        java.io.PushbackInputStream <|- - NoCloseInputStream
        java.io.InputStream <|- - Sha256InputStreamDecorator
    }

    namespace java.io {
        class PushbackInputStream [[https://docs.oracle.com/javase/8/docs/api/java/io/PushbackInputStream.html?is-external=true]] {
            #buf: byte[]
            #pos: int
        }
        abstract class InputStream [[https://docs.oracle.com/javase/8/docs/api/java/io/InputStream.html?is-external=true]] {
            {abstract} +read(): int
        }
    }

    center footer UMLDoclet 2.0.7, PlantUML 1.2019.12
@enduml

PlantUML version 1.2019.12(Sun Nov 03 10:24:54 UTC 2019)
(APACHE source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.8+10
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>