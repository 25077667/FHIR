<?xml version="1.0" encoding="UTF-8"?>
<library xmlns="urn:hl7-org:elm:r1"
    xmlns:t="urn:hl7-org:elm-types:r1"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:xsd="http://www.w3.org/2001/XMLSchema"
    xmlns:fhir="http://hl7.org/fhir"
    xmlns:qdm43="urn:healthit-gov:qdm:v4_3"
    xmlns:qdm53="urn:healthit-gov:qdm:v5_3"
    xmlns:a="urn:hl7-org:cql-annotations:r1">
    <annotation translatorVersion="1.5"
        translatorOptions="EnableAnnotations,EnableLocators,DisableListDemotion,DisableListPromotion"
        xsi:type="a:CqlToElmInfo" />
    <annotation libraryId="SupplementalDataElements"
        libraryVersion="2.0.0" startLine="19" startChar="5" endLine="19"
        endChar="31"
        message="Could not resolve identifier Payer in the current library."
        errorType="semantic" errorSeverity="error"
        xsi:type="a:CqlToElmError" />
    <annotation xsi:type="a:Annotation">
        <a:s r="87">
            <a:s>library SupplementalDataElements version '2.0.0'</a:s>
        </a:s>
    </annotation>
    <identifier id="SupplementalDataElements" version="2.0.0" />
    <schemaIdentifier id="urn:hl7-org:elm" version="r1" />
    <usings>
        <def localIdentifier="System" uri="urn:hl7-org:elm-types:r1" />
        <def localId="1" locator="3:1-3:26" localIdentifier="FHIR"
            uri="http://hl7.org/fhir" version="4.0.1">
            <annotation xsi:type="a:Annotation">
                <a:s r="1">
                    <a:s>using </a:s>
                    <a:s>
                        <a:s>FHIR</a:s>
                    </a:s>
                    <a:s> version '4.0.1'</a:s>
                </a:s>
            </annotation>
        </def>
    </usings>
    <includes>
        <def localId="2" locator="5:1-5:54"
            localIdentifier="FHIRHelpers" path="FHIRHelpers"
            version="4.0.1">
            <annotation xsi:type="a:Annotation">
                <a:s r="2">
                    <a:s>include </a:s>
                    <a:s>
                        <a:s>FHIRHelpers</a:s>
                    </a:s>
                    <a:s> version '4.0.1' called FHIRHelpers</a:s>
                </a:s>
            </annotation>
        </def>
    </includes>
    <contexts>
        <def locator="6:1-6:15" name="Patient" />
    </contexts>
    <statements>
        <def locator="6:1-6:15" name="Patient" context="Patient">
            <expression xsi:type="SingletonFrom">
                <operand locator="6:1-6:15"
                    dataType="fhir:Patient"
                    templateId="http://hl7.org/fhir/StructureDefinition/Patient"
                    xsi:type="Retrieve" />
            </expression>
        </def>
        <def localId="30" locator="8:1-16:28" name="SDE Ethnicity"
            context="Patient" accessLevel="Public">
            <annotation xsi:type="a:Annotation">
                <a:s r="30">
                    <a:s>define &quot;SDE Ethnicity&quot;:
                    </a:s>
                    <a:s r="29">
                        <a:s>
                            <a:s r="14">
                                <a:s r="13">
                                    <a:s>(</a:s>
                                    <a:s r="13">
                                        <a:s>flatten </a:s>
                                        <a:s r="12">
                                            <a:s>(
                                            </a:s>
                                            <a:s r="12">
                                                <a:s>
                                                    <a:s r="4">
                                                        <a:s r="3">
                                                            <a:s>
                                                                <a:s>Patient.extension</a:s>
                                                            </a:s>
                                                        </a:s>
                                                        <a:s> Extension</a:s>
                                                    </a:s>
                                                </a:s>
                                                <a:s>
                                                </a:s>
                                                <a:s r="8">
                                                    <a:s>where </a:s>
                                                    <a:s r="8">
                                                        <a:s r="6">
                                                            <a:s
                                                                r="5">
                                                                <a:s>Extension</a:s>
                                                            </a:s>
                                                            <a:s>.</a:s>
                                                            <a:s
                                                                r="6">
                                                                <a:s>url</a:s>
                                                            </a:s>
                                                        </a:s>
                                                        <a:s> = </a:s>
                                                        <a:s r="7">
                                                            <a:s>'http://hl7.org/fhir/us/core/StructureDefinition/us-core-ethnicity'</a:s>
                                                        </a:s>
                                                    </a:s>
                                                </a:s>
                                                <a:s>
                                                </a:s>
                                                <a:s r="11">
                                                    <a:s>return </a:s>
                                                    <a:s r="10">
                                                        <a:s r="9">
                                                            <a:s>Extension</a:s>
                                                        </a:s>
                                                        <a:s>.</a:s>
                                                        <a:s r="10">
                                                            <a:s>extension</a:s>
                                                        </a:s>
                                                    </a:s>
                                                </a:s>
                                            </a:s>
                                            <a:s>
                                                )</a:s>
                                        </a:s>
                                    </a:s>
                                    <a:s>)</a:s>
                                </a:s>
                                <a:s> E</a:s>
                            </a:s>
                        </a:s>
                        <a:s>
                        </a:s>
                        <a:s r="23">
                            <a:s>where </a:s>
                            <a:s r="23">
                                <a:s r="18">
                                    <a:s r="16">
                                        <a:s r="15">
                                            <a:s>E</a:s>
                                        </a:s>
                                        <a:s>.</a:s>
                                        <a:s r="16">
                                            <a:s>url</a:s>
                                        </a:s>
                                    </a:s>
                                    <a:s> = </a:s>
                                    <a:s r="17">
                                        <a:s>'ombCategory'</a:s>
                                    </a:s>
                                </a:s>
                                <a:s>
                                    or
                                </a:s>
                                <a:s r="22">
                                    <a:s r="20">
                                        <a:s r="19">
                                            <a:s>E</a:s>
                                        </a:s>
                                        <a:s>.</a:s>
                                        <a:s r="20">
                                            <a:s>url</a:s>
                                        </a:s>
                                    </a:s>
                                    <a:s> = </a:s>
                                    <a:s r="21">
                                        <a:s>'detailed'</a:s>
                                    </a:s>
                                </a:s>
                            </a:s>
                        </a:s>
                        <a:s>
                        </a:s>
                        <a:s r="28">
                            <a:s>return </a:s>
                            <a:s r="27">
                                <a:s r="25">
                                    <a:s r="24">
                                        <a:s>E</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="25">
                                        <a:s>value</a:s>
                                    </a:s>
                                </a:s>
                                <a:s> as </a:s>
                                <a:s r="26">
                                    <a:s>Coding</a:s>
                                </a:s>
                            </a:s>
                        </a:s>
                    </a:s>
                </a:s>
            </annotation>
            <expression localId="29" locator="9:3-16:28"
                xsi:type="Query">
                <source localId="14" locator="9:3-13:6" alias="E">
                    <expression localId="13"
                        locator="9:3-13:4" xsi:type="Flatten">
                        <operand localId="12"
                            locator="9:12-13:3" xsi:type="Query">
                            <source localId="4"
                                locator="10:5-10:31" alias="Extension">
                                <expression localId="3"
                                    locator="10:5-10:21"
                                    path="extension" xsi:type="Property">
                                    <source name="Patient"
                                        xsi:type="ExpressionRef" />
                                </expression>
                            </source>
                            <where localId="8"
                                locator="11:7-11:95" xsi:type="Equal">
                                <operand name="ToString"
                                    libraryName="FHIRHelpers"
                                    xsi:type="FunctionRef">
                                    <operand localId="6"
                                        locator="11:13-11:25" path="url"
                                        scope="Extension"
                                        xsi:type="Property" />
                                </operand>
                                <operand localId="7"
                                    locator="11:29-11:95"
                                    valueType="t:String"
                                    value="http://hl7.org/fhir/us/core/StructureDefinition/us-core-ethnicity"
                                    xsi:type="Literal" />
                            </where>
                            <return localId="11"
                                locator="12:9-12:34">
                                <expression localId="10"
                                    locator="12:16-12:34"
                                    path="extension" scope="Extension"
                                    xsi:type="Property" />
                            </return>
                        </operand>
                    </expression>
                </source>
                <where localId="23" locator="14:5-15:27"
                    xsi:type="Or">
                    <operand localId="18" locator="14:11-14:31"
                        xsi:type="Equal">
                        <operand name="ToString"
                            libraryName="FHIRHelpers"
                            xsi:type="FunctionRef">
                            <operand localId="16"
                                locator="14:11-14:15" path="url"
                                scope="E" xsi:type="Property" />
                        </operand>
                        <operand localId="17"
                            locator="14:19-14:31" valueType="t:String"
                            value="ombCategory" xsi:type="Literal" />
                    </operand>
                    <operand localId="22" locator="15:10-15:27"
                        xsi:type="Equal">
                        <operand name="ToString"
                            libraryName="FHIRHelpers"
                            xsi:type="FunctionRef">
                            <operand localId="20"
                                locator="15:10-15:14" path="url"
                                scope="E" xsi:type="Property" />
                        </operand>
                        <operand localId="21"
                            locator="15:18-15:27" valueType="t:String"
                            value="detailed" xsi:type="Literal" />
                    </operand>
                </where>
                <return localId="28" locator="16:5-16:28">
                    <expression localId="27"
                        locator="16:12-16:28" strict="false"
                        xsi:type="As">
                        <operand localId="25"
                            locator="16:12-16:18" path="value" scope="E"
                            xsi:type="Property" />
                        <asTypeSpecifier localId="26"
                            locator="16:23-16:28" name="fhir:Coding"
                            xsi:type="NamedTypeSpecifier" />
                    </expression>
                </return>
            </expression>
        </def>
        <def localId="38" locator="18:1-23:7" name="SDE Payer"
            context="Patient" accessLevel="Public">
            <annotation xsi:type="a:Annotation">
                <a:s r="38">
                    <a:s>define &quot;SDE Payer&quot;:
                    </a:s>
                    <a:s r="37">
                        <a:s>
                            <a:s r="32">
                                <a:s r="31">
                                    <a:s r="31">
                                        <a:s>[Coverage: </a:s>
                                        <a:s>
                                            <a:s>type</a:s>
                                        </a:s>
                                        <a:s> in </a:s>
                                        <a:s>
                                            <a:s>&quot;Payer&quot;</a:s>
                                        </a:s>
                                        <a:s>]</a:s>
                                    </a:s>
                                </a:s>
                                <a:s> Payer</a:s>
                            </a:s>
                        </a:s>
                        <a:s>
                        </a:s>
                        <a:s r="36">
                            <a:s>return </a:s>
                            <a:s r="35">
                                <a:s>{
                                </a:s>
                                <a:s>
                                    <a:s>code: </a:s>
                                    <a:s r="34">
                                        <a:s r="33">
                                            <a:s>Payer</a:s>
                                        </a:s>
                                        <a:s>.</a:s>
                                        <a:s r="34">
                                            <a:s>type</a:s>
                                        </a:s>
                                    </a:s>
                                </a:s>
                                <a:s>,
                                    period: Payer.period
                                    }</a:s>
                            </a:s>
                        </a:s>
                    </a:s>
                </a:s>
            </annotation>
            <expression localId="37" locator="19:5-23:7"
                xsi:type="Query">
                <source localId="32" locator="19:5-19:37"
                    alias="Payer">
                    <expression localId="31"
                        locator="19:5-19:31" xsi:type="Null" />
                </source>
                <return localId="36" locator="20:7-23:7">
                    <expression localId="35"
                        locator="20:14-23:7" xsi:type="Null" />
                </return>
            </expression>
        </def>
        <def localId="66" locator="25:1-33:28" name="SDE Race"
            context="Patient" accessLevel="Public">
            <annotation xsi:type="a:Annotation">
                <a:s r="66">
                    <a:s>define &quot;SDE Race&quot;:
                    </a:s>
                    <a:s r="65">
                        <a:s>
                            <a:s r="50">
                                <a:s r="49">
                                    <a:s>(</a:s>
                                    <a:s r="49">
                                        <a:s>flatten </a:s>
                                        <a:s r="48">
                                            <a:s>(
                                            </a:s>
                                            <a:s r="48">
                                                <a:s>
                                                    <a:s r="40">
                                                        <a:s r="39">
                                                            <a:s>
                                                                <a:s>Patient.extension</a:s>
                                                            </a:s>
                                                        </a:s>
                                                        <a:s> Extension</a:s>
                                                    </a:s>
                                                </a:s>
                                                <a:s>
                                                </a:s>
                                                <a:s r="44">
                                                    <a:s>where </a:s>
                                                    <a:s r="44">
                                                        <a:s r="42">
                                                            <a:s
                                                                r="41">
                                                                <a:s>Extension</a:s>
                                                            </a:s>
                                                            <a:s>.</a:s>
                                                            <a:s
                                                                r="42">
                                                                <a:s>url</a:s>
                                                            </a:s>
                                                        </a:s>
                                                        <a:s> = </a:s>
                                                        <a:s r="43">
                                                            <a:s>'http://hl7.org/fhir/us/core/StructureDefinition/us-core-race'</a:s>
                                                        </a:s>
                                                    </a:s>
                                                </a:s>
                                                <a:s>
                                                </a:s>
                                                <a:s r="47">
                                                    <a:s>return </a:s>
                                                    <a:s r="46">
                                                        <a:s r="45">
                                                            <a:s>Extension</a:s>
                                                        </a:s>
                                                        <a:s>.</a:s>
                                                        <a:s r="46">
                                                            <a:s>extension</a:s>
                                                        </a:s>
                                                    </a:s>
                                                </a:s>
                                            </a:s>
                                            <a:s>
                                                )</a:s>
                                        </a:s>
                                    </a:s>
                                    <a:s>)</a:s>
                                </a:s>
                                <a:s> E</a:s>
                            </a:s>
                        </a:s>
                        <a:s>
                        </a:s>
                        <a:s r="59">
                            <a:s>where </a:s>
                            <a:s r="59">
                                <a:s r="54">
                                    <a:s r="52">
                                        <a:s r="51">
                                            <a:s>E</a:s>
                                        </a:s>
                                        <a:s>.</a:s>
                                        <a:s r="52">
                                            <a:s>url</a:s>
                                        </a:s>
                                    </a:s>
                                    <a:s> = </a:s>
                                    <a:s r="53">
                                        <a:s>'ombCategory'</a:s>
                                    </a:s>
                                </a:s>
                                <a:s>
                                    or
                                </a:s>
                                <a:s r="58">
                                    <a:s r="56">
                                        <a:s r="55">
                                            <a:s>E</a:s>
                                        </a:s>
                                        <a:s>.</a:s>
                                        <a:s r="56">
                                            <a:s>url</a:s>
                                        </a:s>
                                    </a:s>
                                    <a:s> = </a:s>
                                    <a:s r="57">
                                        <a:s>'detailed'</a:s>
                                    </a:s>
                                </a:s>
                            </a:s>
                        </a:s>
                        <a:s>
                        </a:s>
                        <a:s r="64">
                            <a:s>return </a:s>
                            <a:s r="63">
                                <a:s r="61">
                                    <a:s r="60">
                                        <a:s>E</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="61">
                                        <a:s>value</a:s>
                                    </a:s>
                                </a:s>
                                <a:s> as </a:s>
                                <a:s r="62">
                                    <a:s>Coding</a:s>
                                </a:s>
                            </a:s>
                        </a:s>
                    </a:s>
                </a:s>
            </annotation>
            <expression localId="65" locator="26:3-33:28"
                xsi:type="Query">
                <source localId="50" locator="26:3-30:6"
                    alias="E">
                    <expression localId="49"
                        locator="26:3-30:4" xsi:type="Flatten">
                        <operand localId="48"
                            locator="26:12-30:3" xsi:type="Query">
                            <source localId="40"
                                locator="27:5-27:31" alias="Extension">
                                <expression localId="39"
                                    locator="27:5-27:21"
                                    path="extension" xsi:type="Property">
                                    <source name="Patient"
                                        xsi:type="ExpressionRef" />
                                </expression>
                            </source>
                            <where localId="44"
                                locator="28:7-28:90" xsi:type="Equal">
                                <operand name="ToString"
                                    libraryName="FHIRHelpers"
                                    xsi:type="FunctionRef">
                                    <operand localId="42"
                                        locator="28:13-28:25" path="url"
                                        scope="Extension"
                                        xsi:type="Property" />
                                </operand>
                                <operand localId="43"
                                    locator="28:29-28:90"
                                    valueType="t:String"
                                    value="http://hl7.org/fhir/us/core/StructureDefinition/us-core-race"
                                    xsi:type="Literal" />
                            </where>
                            <return localId="47"
                                locator="29:9-29:34">
                                <expression localId="46"
                                    locator="29:16-29:34"
                                    path="extension" scope="Extension"
                                    xsi:type="Property" />
                            </return>
                        </operand>
                    </expression>
                </source>
                <where localId="59" locator="31:5-32:27"
                    xsi:type="Or">
                    <operand localId="54" locator="31:11-31:31"
                        xsi:type="Equal">
                        <operand name="ToString"
                            libraryName="FHIRHelpers"
                            xsi:type="FunctionRef">
                            <operand localId="52"
                                locator="31:11-31:15" path="url"
                                scope="E" xsi:type="Property" />
                        </operand>
                        <operand localId="53"
                            locator="31:19-31:31" valueType="t:String"
                            value="ombCategory" xsi:type="Literal" />
                    </operand>
                    <operand localId="58" locator="32:10-32:27"
                        xsi:type="Equal">
                        <operand name="ToString"
                            libraryName="FHIRHelpers"
                            xsi:type="FunctionRef">
                            <operand localId="56"
                                locator="32:10-32:14" path="url"
                                scope="E" xsi:type="Property" />
                        </operand>
                        <operand localId="57"
                            locator="32:18-32:27" valueType="t:String"
                            value="detailed" xsi:type="Literal" />
                    </operand>
                </where>
                <return localId="64" locator="33:5-33:28">
                    <expression localId="63"
                        locator="33:12-33:28" strict="false"
                        xsi:type="As">
                        <operand localId="61"
                            locator="33:12-33:18" path="value" scope="E"
                            xsi:type="Property" />
                        <asTypeSpecifier localId="62"
                            locator="33:23-33:28" name="fhir:Coding"
                            xsi:type="NamedTypeSpecifier" />
                    </expression>
                </return>
            </expression>
        </def>
        <def localId="87" locator="35:1-40:5" name="SDE Sex"
            context="Patient" accessLevel="Public">
            <annotation xsi:type="a:Annotation">
                <a:s r="87">
                    <a:s>define &quot;SDE Sex&quot;:
                    </a:s>
                    <a:s r="86">
                        <a:s>case
                        </a:s>
                        <a:s r="75">
                            <a:s>when </a:s>
                            <a:s r="70">
                                <a:s r="68">
                                    <a:s r="67">
                                        <a:s>Patient</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="68">
                                        <a:s>gender</a:s>
                                    </a:s>
                                </a:s>
                                <a:s> = </a:s>
                                <a:s r="69">
                                    <a:s>'male'</a:s>
                                </a:s>
                            </a:s>
                            <a:s> then </a:s>
                            <a:s r="74">
                                <a:s>Code { </a:s>
                                <a:s>
                                    <a:s>code: </a:s>
                                    <a:s r="71">
                                        <a:s>'M'</a:s>
                                    </a:s>
                                </a:s>
                                <a:s>, </a:s>
                                <a:s>
                                    <a:s>system: </a:s>
                                    <a:s r="72">
                                        <a:s>'http://hl7.org/fhir/v3/AdministrativeGender'</a:s>
                                    </a:s>
                                </a:s>
                                <a:s>, </a:s>
                                <a:s>
                                    <a:s>display: </a:s>
                                    <a:s r="73">
                                        <a:s>'Male'</a:s>
                                    </a:s>
                                </a:s>
                                <a:s> }</a:s>
                            </a:s>
                        </a:s>
                        <a:s>
                        </a:s>
                        <a:s r="84">
                            <a:s>when </a:s>
                            <a:s r="79">
                                <a:s r="77">
                                    <a:s r="76">
                                        <a:s>Patient</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="77">
                                        <a:s>gender</a:s>
                                    </a:s>
                                </a:s>
                                <a:s> = </a:s>
                                <a:s r="78">
                                    <a:s>'female'</a:s>
                                </a:s>
                            </a:s>
                            <a:s> then </a:s>
                            <a:s r="83">
                                <a:s>Code { </a:s>
                                <a:s>
                                    <a:s>code: </a:s>
                                    <a:s r="80">
                                        <a:s>'F'</a:s>
                                    </a:s>
                                </a:s>
                                <a:s>, </a:s>
                                <a:s>
                                    <a:s>system: </a:s>
                                    <a:s r="81">
                                        <a:s>'http://hl7.org/fhir/v3/AdministrativeGender'</a:s>
                                    </a:s>
                                </a:s>
                                <a:s>, </a:s>
                                <a:s>
                                    <a:s>display: </a:s>
                                    <a:s r="82">
                                        <a:s>'Female'</a:s>
                                    </a:s>
                                </a:s>
                                <a:s> }</a:s>
                            </a:s>
                        </a:s>
                        <a:s r="85">
                            else null
                            end</a:s>
                    </a:s>
                </a:s>
            </annotation>
            <expression localId="86" locator="36:3-40:5"
                xsi:type="Case">
                <caseItem localId="75" locator="37:5-37:128">
                    <when localId="70" locator="37:10-37:32"
                        xsi:type="Equal">
                        <operand name="ToString"
                            libraryName="FHIRHelpers"
                            xsi:type="FunctionRef">
                            <operand localId="68"
                                locator="37:10-37:23" path="gender"
                                xsi:type="Property">
                                <source localId="67"
                                    locator="37:10-37:16" name="Patient"
                                    xsi:type="ExpressionRef" />
                            </operand>
                        </operand>
                        <operand localId="69"
                            locator="37:27-37:32" valueType="t:String"
                            value="male" xsi:type="Literal" />
                    </when>
                    <then localId="74" locator="37:39-37:128"
                        classType="t:Code" xsi:type="Instance">
                        <element name="code">
                            <value localId="71"
                                locator="37:52-37:54"
                                valueType="t:String" value="M"
                                xsi:type="Literal" />
                        </element>
                        <element name="system">
                            <value localId="72"
                                locator="37:65-37:109"
                                valueType="t:String"
                                value="http://hl7.org/fhir/v3/AdministrativeGender"
                                xsi:type="Literal" />
                        </element>
                        <element name="display">
                            <value localId="73"
                                locator="37:121-37:126"
                                valueType="t:String" value="Male"
                                xsi:type="Literal" />
                        </element>
                    </then>
                </caseItem>
                <caseItem localId="84" locator="38:5-38:132">
                    <when localId="79" locator="38:10-38:34"
                        xsi:type="Equal">
                        <operand name="ToString"
                            libraryName="FHIRHelpers"
                            xsi:type="FunctionRef">
                            <operand localId="77"
                                locator="38:10-38:23" path="gender"
                                xsi:type="Property">
                                <source localId="76"
                                    locator="38:10-38:16" name="Patient"
                                    xsi:type="ExpressionRef" />
                            </operand>
                        </operand>
                        <operand localId="78"
                            locator="38:27-38:34" valueType="t:String"
                            value="female" xsi:type="Literal" />
                    </when>
                    <then localId="83" locator="38:41-38:132"
                        classType="t:Code" xsi:type="Instance">
                        <element name="code">
                            <value localId="80"
                                locator="38:54-38:56"
                                valueType="t:String" value="F"
                                xsi:type="Literal" />
                        </element>
                        <element name="system">
                            <value localId="81"
                                locator="38:67-38:111"
                                valueType="t:String"
                                value="http://hl7.org/fhir/v3/AdministrativeGender"
                                xsi:type="Literal" />
                        </element>
                        <element name="display">
                            <value localId="82"
                                locator="38:123-38:130"
                                valueType="t:String" value="Female"
                                xsi:type="Literal" />
                        </element>
                    </then>
                </caseItem>
                <else asType="t:Code" xsi:type="As">
                    <operand localId="85" locator="39:10-39:13"
                        xsi:type="Null" />
                </else>
            </expression>
        </def>
    </statements>
</library>